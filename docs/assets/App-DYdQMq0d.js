import{g as ri,a as ii,s as ai,r as v,u as si,j as z,h as oi,i as li,k as ci,_ as ui,R as qt,o as di,T as Nn,l as fi}from"./index-BOMop6e3.js";import{x as sa,d as Ge,i as pt,y as Et,o as we,O as jn,z as Zn,V as Te,A as un,r as Jt,Q as bt,I as hi,J as _n,E as oa,K as la,M as en,X as ca,S as Ze,Y as pi,Z as mi,H as Le,F as Ke,_ as St,L as Ie,$ as Yt,m as ua,g as Fn,a0 as da,a1 as ut,f as yn,P as vi,W as $e,a2 as xn,a3 as fa,a4 as ha,a5 as Qt,a6 as dt,a7 as pa,a8 as ma,a9 as va,aa as gi,ab as ht,k as yi,ac as vn,ad as ga,ae as ya,af as lr,ag as Qe,ah as Rt,ai as wn,aj as xa,ak as wa,al as Ea,am as Sa,h as _a,j as $n,b as cr,D as Ma,an as Ta,ao as ba,ap as Xn,aq as xi,ar as Ct,N as Tt,as as Ra,at as Ca,au as dn,av as Aa,aw as ie,ax as wi,l as Ia,R as qn,ay as Ei,az as ur,aA as Pa,n as Si,G as Da,q as La,c as gn,C as Ba,aB as Oa,aC as dr,aD as Na,s as Fa,t as Ua,v as Ha,w as za,aE as ka}from"./HamburgerMenu-C2YDGRCN.js";function Ga(e){return ii("MuiCard",e)}ri("MuiCard",["root"]);const Wa=e=>{const{classes:t}=e;return li({root:["root"]},Ga,t)},Va=ai(sa,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})({overflow:"hidden"}),ja=v.forwardRef(function(t,n){const r=si({props:t,name:"MuiCard"}),{className:a,raised:o=!1,...l}=r,u={...r,raised:o},d=Wa(u);return z.jsx(Va,{className:oi(d.root,a),elevation:o?8:void 0,ref:n,ownerState:u,...l})});function Za(e){return ii("MuiCardContent",e)}ri("MuiCardContent",["root"]);const $a=e=>{const{classes:t}=e;return li({root:["root"]},Za,t)},Xa=ai("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:16,"&:last-child":{paddingBottom:24}}),qa=v.forwardRef(function(t,n){const r=si({props:t,name:"MuiCardContent"}),{className:a,component:o="div",...l}=r,u={...r,component:o},d=$a(u);return z.jsx(Xa,{as:o,className:oi(d.root,a),ownerState:u,ref:n,...l})}),tn=new we,Yn=new we,Ya=new we,fr=new Te;function Qa(e,t,n){const r=tn.setFromMatrixPosition(e.matrixWorld);r.project(t);const a=n.width/2,o=n.height/2;return[r.x*a+a,-(r.y*o)+o]}function Ka(e,t){const n=tn.setFromMatrixPosition(e.matrixWorld),r=Yn.setFromMatrixPosition(t.matrixWorld),a=n.sub(r),o=t.getWorldDirection(Ya);return a.angleTo(o)>Math.PI/2}function Ja(e,t,n,r){const a=tn.setFromMatrixPosition(e.matrixWorld),o=a.clone();o.project(t),fr.set(o.x,o.y),n.setFromCamera(fr,t);const l=n.intersectObjects(r,!0);if(l.length){const u=l[0].distance;return a.distanceTo(n.ray.origin)<u}return!0}function es(e,t){if(t instanceof jn)return t.zoom;if(t instanceof Zn){const n=tn.setFromMatrixPosition(e.matrixWorld),r=Yn.setFromMatrixPosition(t.matrixWorld),a=t.fov*Math.PI/180,o=n.distanceTo(r);return 1/(2*Math.tan(a/2)*o)}else return 1}function ts(e,t,n){if(t instanceof Zn||t instanceof jn){const r=tn.setFromMatrixPosition(e.matrixWorld),a=Yn.setFromMatrixPosition(t.matrixWorld),o=r.distanceTo(a),l=(n[1]-n[0])/(t.far-t.near),u=n[1]-l*t.far;return Math.round(l*o+u)}}const Un=e=>Math.abs(e)<1e-10?0:e;function _i(e,t,n=""){let r="matrix3d(";for(let a=0;a!==16;a++)r+=Un(t[a]*e.elements[a])+(a!==15?",":")");return n+r}const ns=(e=>t=>_i(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),rs=(e=>(t,n)=>_i(t,e(n),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function is(e){return e&&typeof e=="object"&&"current"in e}const as=v.forwardRef(({children:e,eps:t=.001,style:n,className:r,prepend:a,center:o,fullscreen:l,portal:u,distanceFactor:d,sprite:h=!1,transform:y=!1,occlude:x,onOcclude:S,castShadow:B,receiveShadow:j,material:$,geometry:G,zIndexRange:P=[16777271,0],calculatePosition:U=Qa,as:D="div",wrapperClass:X,pointerEvents:Z="auto",...O},K)=>{const{gl:E,camera:g,scene:H,size:R,raycaster:N,events:M,viewport:I}=Ge(),[F]=v.useState(()=>document.createElement(D)),W=v.useRef(),pe=v.useRef(null),Xe=v.useRef(0),Ee=v.useRef([0,0]),te=v.useRef(null),Oe=v.useRef(null),ne=(u==null?void 0:u.current)||M.connected||E.domElement.parentNode,ce=v.useRef(null),be=v.useRef(!1),qe=v.useMemo(()=>x&&x!=="blending"||Array.isArray(x)&&x.length&&is(x[0]),[x]);v.useLayoutEffect(()=>{const Re=E.domElement;x&&x==="blending"?(Re.style.zIndex=`${Math.floor(P[0]/2)}`,Re.style.position="absolute",Re.style.pointerEvents="none"):(Re.style.zIndex=null,Re.style.position=null,Re.style.pointerEvents=null)},[x]),v.useLayoutEffect(()=>{if(pe.current){const Re=W.current=ci.createRoot(F);if(H.updateMatrixWorld(),y)F.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const se=U(pe.current,g,R);F.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${se[0]}px,${se[1]}px,0);transform-origin:0 0;`}return ne&&(a?ne.prepend(F):ne.appendChild(F)),()=>{ne&&ne.removeChild(F),Re.unmount()}}},[ne,y]),v.useLayoutEffect(()=>{X&&(F.className=X)},[X]);const re=v.useMemo(()=>y?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:o?"translate3d(-50%,-50%,0)":"none",...l&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...n},[n,o,l,R,y]),We=v.useMemo(()=>({position:"absolute",pointerEvents:Z}),[Z]);v.useLayoutEffect(()=>{if(be.current=!1,y){var Re;(Re=W.current)==null||Re.render(v.createElement("div",{ref:te,style:re},v.createElement("div",{ref:Oe,style:We},v.createElement("div",{ref:K,className:r,style:n,children:e}))))}else{var se;(se=W.current)==null||se.render(v.createElement("div",{ref:K,style:re,className:r,children:e}))}});const Se=v.useRef(!0);pt(Re=>{if(pe.current){g.updateMatrixWorld(),pe.current.updateWorldMatrix(!0,!1);const se=y?Ee.current:U(pe.current,g,R);if(y||Math.abs(Xe.current-g.zoom)>t||Math.abs(Ee.current[0]-se[0])>t||Math.abs(Ee.current[1]-se[1])>t){const Je=Ka(pe.current,g);let Ne=!1;qe&&(Array.isArray(x)?Ne=x.map(et=>et.current):x!=="blending"&&(Ne=[H]));const st=Se.current;if(Ne){const et=Ja(pe.current,g,N,Ne);Se.current=et&&!Je}else Se.current=!Je;st!==Se.current&&(S?S(!Se.current):F.style.display=Se.current?"block":"none");const mt=Math.floor(P[0]/2),Tn=x?qe?[P[0],mt]:[mt-1,0]:P;if(F.style.zIndex=`${ts(pe.current,g,Tn)}`,y){const[et,an]=[R.width/2,R.height/2],At=g.projectionMatrix.elements[5]*an,{isOrthographicCamera:sn,top:bn,left:Rn,bottom:on,right:Cn}=g,It=ns(g.matrixWorldInverse),An=sn?`scale(${At})translate(${Un(-(Cn+Rn)/2)}px,${Un((bn+on)/2)}px)`:`translateZ(${At}px)`;let tt=pe.current.matrixWorld;h&&(tt=g.matrixWorldInverse.clone().transpose().copyPosition(tt).scale(pe.current.scale),tt.elements[3]=tt.elements[7]=tt.elements[11]=0,tt.elements[15]=1),F.style.width=R.width+"px",F.style.height=R.height+"px",F.style.perspective=sn?"":`${At}px`,te.current&&Oe.current&&(te.current.style.transform=`${An}${It}translate(${et}px,${an}px)`,Oe.current.style.transform=rs(tt,1/((d||10)/400)))}else{const et=d===void 0?1:es(pe.current,g)*d;F.style.transform=`translate3d(${se[0]}px,${se[1]}px,0) scale(${et})`}Ee.current=se,Xe.current=g.zoom}}if(!qe&&ce.current&&!be.current)if(y){if(te.current){const se=te.current.children[0];if(se!=null&&se.clientWidth&&se!=null&&se.clientHeight){const{isOrthographicCamera:Je}=g;if(Je||G)O.scale&&(Array.isArray(O.scale)?O.scale instanceof we?ce.current.scale.copy(O.scale.clone().divideScalar(1)):ce.current.scale.set(1/O.scale[0],1/O.scale[1],1/O.scale[2]):ce.current.scale.setScalar(1/O.scale));else{const Ne=(d||10)/400,st=se.clientWidth*Ne,mt=se.clientHeight*Ne;ce.current.scale.set(st,mt,1)}be.current=!0}}}else{const se=F.children[0];if(se!=null&&se.clientWidth&&se!=null&&se.clientHeight){const Je=1/I.factor,Ne=se.clientWidth*Je,st=se.clientHeight*Je;ce.current.scale.set(Ne,st,1),be.current=!0}ce.current.lookAt(Re.camera.position)}});const rn=v.useMemo(()=>({vertexShader:y?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[y]);return v.createElement("group",ui({},O,{ref:pe}),x&&!qe&&v.createElement("mesh",{castShadow:B,receiveShadow:j,ref:ce},G||v.createElement("planeGeometry",null),$||v.createElement("shaderMaterial",{side:Et,vertexShader:rn.vertexShader,fragmentShader:rn.fragmentShader})))}),hr=e=>{let t;const n=new Set,r=(h,y)=>{const x=typeof h=="function"?h(t):h;if(!Object.is(x,t)){const S=t;t=y??(typeof x!="object"||x===null)?x:Object.assign({},t,x),n.forEach(B=>B(t,S))}},a=()=>t,u={setState:r,getState:a,getInitialState:()=>d,subscribe:h=>(n.add(h),()=>n.delete(h))},d=t=e(r,a,u);return u},ss=e=>e?hr(e):hr,os=e=>e;function ls(e,t=os){const n=qt.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return qt.useDebugValue(n),n}const pr=e=>{const t=ss(e),n=r=>ls(t,r);return Object.assign(n,t),n},cs=e=>e?pr(e):pr;let Nt=0;const us=cs(e=>(un.onStart=(t,n,r)=>{e({active:!0,item:t,loaded:n,total:r,progress:(n-Nt)/(r-Nt)*100})},un.onLoad=()=>{e({active:!1})},un.onError=t=>e(n=>({errors:[...n.errors,t]})),un.onProgress=(t,n,r)=>{n===r&&(Nt=r),e({active:!0,item:t,loaded:n,total:r,progress:(n-Nt)/(r-Nt)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function $t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hn(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ds(e,t){if(e){if(typeof e=="string")return Hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hn(e,t)}}function fs(e){if(Array.isArray(e))return Hn(e)}function hs(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ps(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ms(e){return fs(e)||hs(e)||ds(e)||ps()}new Te;new Te;function vs(e,t,n){return Math.max(t,Math.min(n,e))}function gs(e,t){return vs(e-Math.floor(e/t)*t,0,t)}function ys(e,t){var n=gs(t-e,Math.PI*2);return n>Math.PI&&(n-=Math.PI*2),n}function Mi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ze=function e(t,n,r){var a=this;Mi(this,e),$t(this,"dot2",function(o,l){return a.x*o+a.y*l}),$t(this,"dot3",function(o,l,u){return a.x*o+a.y*l+a.z*u}),this.x=t,this.y=n,this.z=r},xs=[new ze(1,1,0),new ze(-1,1,0),new ze(1,-1,0),new ze(-1,-1,0),new ze(1,0,1),new ze(-1,0,1),new ze(1,0,-1),new ze(-1,0,-1),new ze(0,1,1),new ze(0,-1,1),new ze(0,1,-1),new ze(0,-1,-1)],mr=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],vr=new Array(512),gr=new Array(512),ws=function(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(var n=0;n<256;n++){var r;n&1?r=mr[n]^t&255:r=mr[n]^t>>8&255,vr[n]=vr[n+256]=r,gr[n]=gr[n+256]=xs[r%12]}};ws(0);function Es(e){if(typeof e=="number")e=Math.abs(e);else if(typeof e=="string"){var t=e;e=0;for(var n=0;n<t.length;n++)e=(e+(n+1)*(t.charCodeAt(n)%96))%2147483647}return e===0&&(e=311),e}function yr(e){var t=Es(e);return function(){var n=t*48271%2147483647;return t=n,n/2147483647}}var Ss=function e(t){var n=this;Mi(this,e),$t(this,"seed",0),$t(this,"init",function(r){n.seed=r,n.value=yr(r)}),$t(this,"value",yr(this.seed)),this.init(t)};new Ss(Math.random());var _s=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return r/Math.atan(1/n)*Math.atan(Math.sin(2*Math.PI*t*a)/n)},Ti=function(t){return 1/(1+t+.48*t*t+.235*t*t*t)},Ms=function(t){return t},Ts={in:function(t){return 1-Math.cos(t*Math.PI/2)},out:function(t){return Math.sin(t*Math.PI/2)},inOut:function(t){return-(Math.cos(Math.PI*t)-1)/2}},bs={in:function(t){return t*t*t},out:function(t){return 1-Math.pow(1-t,3)},inOut:function(t){return t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2}},Rs={in:function(t){return t*t*t*t*t},out:function(t){return 1-Math.pow(1-t,5)},inOut:function(t){return t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2}},Cs={in:function(t){return 1-Math.sqrt(1-Math.pow(t,2))},out:function(t){return Math.sqrt(1-Math.pow(t-1,2))},inOut:function(t){return t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2}},As={in:function(t){return t*t*t*t},out:function(t){return 1- --t*t*t*t},inOut:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t}},Is={in:function(t){return t===0?0:Math.pow(2,10*t-10)},out:function(t){return t===1?1:1-Math.pow(2,-10*t)},inOut:function(t){return t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}};function ye(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Ti,u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,d="velocity_"+t;if(e.__damp===void 0&&(e.__damp={}),e.__damp[d]===void 0&&(e.__damp[d]=0),Math.abs(e[t]-n)<=u)return e[t]=n,!1;r=Math.max(1e-4,r);var h=2/r,y=l(h*a),x=e[t]-n,S=n,B=o*r;x=Math.min(Math.max(x,-B),B),n=e[t]-x;var j=(e.__damp[d]+h*x)*a;e.__damp[d]=(e.__damp[d]-h*j)*y;var $=n+(x+j)*y;return S-e[t]>0==$>S&&($=S,e.__damp[d]=($-S)/a),e[t]=$,!0}var Ps=function(t){return t&&t.isCamera},Ds=function(t){return t&&t.isLight},Ft=new we,xr=new bt,wr=new bt,Ut=new hi,In=new we;function Ls(e,t,n,r,a,o,l){typeof t=="number"?Ft.setScalar(t):Array.isArray(t)?Ft.set(t[0],t[1],t[2]):Ft.copy(t);var u=e.parent;e.updateWorldMatrix(!0,!1),In.setFromMatrixPosition(e.matrixWorld),Ps(e)||Ds(e)?Ut.lookAt(In,Ft,e.up):Ut.lookAt(Ft,In,e.up),En(e.quaternion,wr.setFromRotationMatrix(Ut),n,r,a,o,l),u&&(Ut.extractRotation(u.matrixWorld),xr.setFromRotationMatrix(Ut),En(e.quaternion,wr.copy(e.quaternion).premultiply(xr.invert()),n,r,a,o,l))}function _t(e,t,n,r,a,o,l,u){return ye(e,t,e[t]+ys(e[t],n),r,a,o,l,u)}var Ht=new Te,Er,Sr;function Bs(e,t,n,r,a,o,l){return typeof t=="number"?Ht.setScalar(t):Array.isArray(t)?Ht.set(t[0],t[1]):Ht.copy(t),Er=ye(e,"x",Ht.x,n,r,a,o,l),Sr=ye(e,"y",Ht.y,n,r,a,o,l),Er||Sr}var xt=new we,_r,Mr,Tr;function zn(e,t,n,r,a,o,l){return typeof t=="number"?xt.setScalar(t):Array.isArray(t)?xt.set(t[0],t[1],t[2]):xt.copy(t),_r=ye(e,"x",xt.x,n,r,a,o,l),Mr=ye(e,"y",xt.y,n,r,a,o,l),Tr=ye(e,"z",xt.z,n,r,a,o,l),_r||Mr||Tr}var gt=new _n,br,Rr,Cr,Ar;function Os(e,t,n,r,a,o,l){return typeof t=="number"?gt.setScalar(t):Array.isArray(t)?gt.set(t[0],t[1],t[2],t[3]):gt.copy(t),br=ye(e,"x",gt.x,n,r,a,o,l),Rr=ye(e,"y",gt.y,n,r,a,o,l),Cr=ye(e,"z",gt.z,n,r,a,o,l),Ar=ye(e,"w",gt.w,n,r,a,o,l),br||Rr||Cr||Ar}var zt=new oa,Ir,Pr,Dr;function Ns(e,t,n,r,a,o,l){return Array.isArray(t)?zt.set(t[0],t[1],t[2],t[3]):zt.copy(t),Ir=_t(e,"x",zt.x,n,r,a,o,l),Pr=_t(e,"y",zt.y,n,r,a,o,l),Dr=_t(e,"z",zt.z,n,r,a,o,l),Ir||Pr||Dr}var wt=new Jt,Lr,Br,Or;function Fs(e,t,n,r,a,o,l){return t instanceof Jt?wt.copy(t):Array.isArray(t)?wt.setRGB(t[0],t[1],t[2]):wt.set(t),Lr=ye(e,"r",wt.r,n,r,a,o,l),Br=ye(e,"g",wt.g,n,r,a,o,l),Or=ye(e,"b",wt.b,n,r,a,o,l),Lr||Br||Or}var Ve=new bt,rt=new _n,Nr=new _n,kt=new _n,Fr,Ur,Hr,zr;function En(e,t,n,r,a,o,l){var u=e;Array.isArray(t)?Ve.set(t[0],t[1],t[2],t[3]):Ve.copy(t);var d=e.dot(Ve)>0?1:-1;return Ve.x*=d,Ve.y*=d,Ve.z*=d,Ve.w*=d,Fr=ye(e,"x",Ve.x,n,r,a,o,l),Ur=ye(e,"y",Ve.y,n,r,a,o,l),Hr=ye(e,"z",Ve.z,n,r,a,o,l),zr=ye(e,"w",Ve.w,n,r,a,o,l),rt.set(e.x,e.y,e.z,e.w).normalize(),Nr.set(u.__damp.velocity_x,u.__damp.velocity_y,u.__damp.velocity_z,u.__damp.velocity_w),kt.copy(rt).multiplyScalar(Nr.dot(rt)/rt.dot(rt)),u.__damp.velocity_x-=kt.x,u.__damp.velocity_y-=kt.y,u.__damp.velocity_z-=kt.z,u.__damp.velocity_w-=kt.w,e.set(rt.x,rt.y,rt.z,rt.w),Fr||Ur||Hr||zr}var Gt=new la,kr,Gr,Wr;function Us(e,t,n,r,a,o,l){return Array.isArray(t)?Gt.set(t[0],t[1],t[2]):Gt.copy(t),kr=ye(e,"radius",Gt.radius,n,r,a,o,l),Gr=_t(e,"phi",Gt.phi,n,r,a,o,l),Wr=_t(e,"theta",Gt.theta,n,r,a,o,l),kr||Gr||Wr}var fn=new hi,Vr=new we,jr=new bt,Zr=new we,$r,Xr,qr;function Hs(e,t,n,r,a,o,l){var u=e;return u.__damp===void 0&&(u.__damp={position:new we,rotation:new bt,scale:new we},e.decompose(u.__damp.position,u.__damp.rotation,u.__damp.scale)),Array.isArray(t)?fn.set.apply(fn,ms(t)):fn.copy(t),fn.decompose(Vr,jr,Zr),$r=zn(u.__damp.position,Vr,n,r,a,o,l),Xr=En(u.__damp.rotation,jr,n,r,a,o,l),qr=zn(u.__damp.scale,Zr,n,r,a,o,l),e.compose(u.__damp.position,u.__damp.rotation,u.__damp.scale),$r||Xr||qr}var Yr=Object.freeze({__proto__:null,rsqw:_s,exp:Ti,linear:Ms,sine:Ts,cubic:bs,quint:Rs,circ:Cs,quart:As,expo:Is,damp:ye,dampLookAt:Ls,dampAngle:_t,damp2:Bs,damp3:zn,damp4:Os,dampE:Ns,dampC:Fs,dampQ:En,dampS:Us,dampM:Hs});const bi=v.createContext(null);function zs(){return v.useContext(bi)}function ks({eps:e=1e-5,enabled:t=!0,infinite:n,horizontal:r,pages:a=1,distance:o=1,damping:l=.25,maxSpeed:u=1/0,prepend:d=!1,style:h={},children:y}){const{get:x,setEvents:S,gl:B,size:j,invalidate:$,events:G}=Ge(),[P]=v.useState(()=>document.createElement("div")),[U]=v.useState(()=>document.createElement("div")),[D]=v.useState(()=>document.createElement("div")),X=B.domElement.parentNode,Z=v.useRef(0),O=v.useMemo(()=>({el:P,eps:e,fill:U,fixed:D,horizontal:r,damping:l,offset:0,delta:0,scroll:Z,pages:a,range(g,H,R=0){const N=g-R,M=N+H+R*2;return this.offset<N?0:this.offset>M?1:(this.offset-N)/(M-N)},curve(g,H,R=0){return Math.sin(this.range(g,H,R)*Math.PI)},visible(g,H,R=0){const N=g-R,M=N+H+R*2;return this.offset>=N&&this.offset<=M}}),[e,l,r,a]);v.useEffect(()=>{P.style.position="absolute",P.style.width="100%",P.style.height="100%",P.style[r?"overflowX":"overflowY"]="auto",P.style[r?"overflowY":"overflowX"]="hidden",P.style.top="0px",P.style.left="0px";for(const H in h)P.style[H]=h[H];D.style.position="sticky",D.style.top="0px",D.style.left="0px",D.style.width="100%",D.style.height="100%",D.style.overflow="hidden",P.appendChild(D),U.style.height=r?"100%":`${a*o*100}%`,U.style.width=r?`${a*o*100}%`:"100%",U.style.pointerEvents="none",P.appendChild(U),d?X.prepend(P):X.appendChild(P),P[r?"scrollLeft":"scrollTop"]=1;const E=G.connected||B.domElement;requestAnimationFrame(()=>G.connect==null?void 0:G.connect(P));const g=x().events.compute;return S({compute(H,R){const{left:N,top:M}=X.getBoundingClientRect(),I=H.clientX-N,F=H.clientY-M;R.pointer.set(I/R.size.width*2-1,-(F/R.size.height)*2+1),R.raycaster.setFromCamera(R.pointer,R.camera)}}),()=>{X.removeChild(P),S({compute:g}),G.connect==null||G.connect(E)}},[a,o,r,P,U,D,X]),v.useEffect(()=>{if(G.connected===P){const E=j[r?"width":"height"],g=P[r?"scrollWidth":"scrollHeight"],H=g-E;let R=0,N=!0,M=!0;const I=()=>{if(!(!t||M)&&($(),R=P[r?"scrollLeft":"scrollTop"],Z.current=R/H,n)){if(!N){if(R>=H){const W=1-O.offset;P[r?"scrollLeft":"scrollTop"]=1,Z.current=O.offset=-W,N=!0}else if(R<=0){const W=1+O.offset;P[r?"scrollLeft":"scrollTop"]=g,Z.current=O.offset=W,N=!0}}N&&setTimeout(()=>N=!1,40)}};P.addEventListener("scroll",I,{passive:!0}),requestAnimationFrame(()=>M=!1);const F=W=>P.scrollLeft+=W.deltaY/2;return r&&P.addEventListener("wheel",F,{passive:!0}),()=>{P.removeEventListener("scroll",I),r&&P.removeEventListener("wheel",F)}}},[P,G,j,n,O,$,r,t]);let K=0;return pt((E,g)=>{K=O.offset,Yr.damp(O,"offset",Z.current,l,g,u,void 0,e),Yr.damp(O,"delta",Math.abs(K-O.offset),l,g,u,void 0,e),O.delta>e&&$()}),v.createElement(bi.Provider,{value:O},y)}let Wt;function Gs(){var e;if(Wt!==void 0)return Wt;try{let t;const n=document.createElement("canvas");return Wt=!!(window.WebGL2RenderingContext&&(t=n.getContext("webgl2"))),t&&((e=t.getExtension("WEBGL_lose_context"))==null||e.loseContext()),Wt}catch{return Wt=!1}}var ke=Uint8Array,ft=Uint16Array,kn=Uint32Array,Ri=new ke([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ci=new ke([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ws=new ke([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ai=function(e,t){for(var n=new ft(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var a=new kn(n[30]),r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)a[o]=o-n[r]<<5|r;return[n,a]},Ii=Ai(Ri,2),Pi=Ii[0],Vs=Ii[1];Pi[28]=258,Vs[258]=28;var js=Ai(Ci,0),Zs=js[0],Gn=new ft(32768);for(var he=0;he<32768;++he){var lt=(he&43690)>>>1|(he&21845)<<1;lt=(lt&52428)>>>2|(lt&13107)<<2,lt=(lt&61680)>>>4|(lt&3855)<<4,Gn[he]=((lt&65280)>>>8|(lt&255)<<8)>>>1}var Xt=function(e,t,n){for(var r=e.length,a=0,o=new ft(t);a<r;++a)++o[e[a]-1];var l=new ft(t);for(a=0;a<t;++a)l[a]=l[a-1]+o[a-1]<<1;var u;if(n){u=new ft(1<<t);var d=15-t;for(a=0;a<r;++a)if(e[a])for(var h=a<<4|e[a],y=t-e[a],x=l[e[a]-1]++<<y,S=x|(1<<y)-1;x<=S;++x)u[Gn[x]>>>d]=h}else for(u=new ft(r),a=0;a<r;++a)e[a]&&(u[a]=Gn[l[e[a]-1]++]>>>15-e[a]);return u},nn=new ke(288);for(var he=0;he<144;++he)nn[he]=8;for(var he=144;he<256;++he)nn[he]=9;for(var he=256;he<280;++he)nn[he]=7;for(var he=280;he<288;++he)nn[he]=8;var Di=new ke(32);for(var he=0;he<32;++he)Di[he]=5;var $s=Xt(nn,9,1),Xs=Xt(Di,5,1),Pn=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},je=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Dn=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},qs=function(e){return(e/8|0)+(e&7&&1)},Ys=function(e,t,n){(n==null||n>e.length)&&(n=e.length);var r=new(e instanceof ft?ft:e instanceof kn?kn:ke)(n-t);return r.set(e.subarray(t,n)),r},Qs=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new ke(0);var a=!t||n,o=!n||n.i;n||(n={}),t||(t=new ke(r*3));var l=function(re){var We=t.length;if(re>We){var Se=new ke(Math.max(We*2,re));Se.set(t),t=Se}},u=n.f||0,d=n.p||0,h=n.b||0,y=n.l,x=n.d,S=n.m,B=n.n,j=r*8;do{if(!y){n.f=u=je(e,d,1);var $=je(e,d+1,3);if(d+=3,$)if($==1)y=$s,x=Xs,S=9,B=5;else if($==2){var D=je(e,d,31)+257,X=je(e,d+10,15)+4,Z=D+je(e,d+5,31)+1;d+=14;for(var O=new ke(Z),K=new ke(19),E=0;E<X;++E)K[Ws[E]]=je(e,d+E*3,7);d+=X*3;for(var g=Pn(K),H=(1<<g)-1,R=Xt(K,g,1),E=0;E<Z;){var N=R[je(e,d,H)];d+=N&15;var G=N>>>4;if(G<16)O[E++]=G;else{var M=0,I=0;for(G==16?(I=3+je(e,d,3),d+=2,M=O[E-1]):G==17?(I=3+je(e,d,7),d+=3):G==18&&(I=11+je(e,d,127),d+=7);I--;)O[E++]=M}}var F=O.subarray(0,D),W=O.subarray(D);S=Pn(F),B=Pn(W),y=Xt(F,S,1),x=Xt(W,B,1)}else throw"invalid block type";else{var G=qs(d)+4,P=e[G-4]|e[G-3]<<8,U=G+P;if(U>r){if(o)throw"unexpected EOF";break}a&&l(h+P),t.set(e.subarray(G,U),h),n.b=h+=P,n.p=d=U*8;continue}if(d>j){if(o)throw"unexpected EOF";break}}a&&l(h+131072);for(var pe=(1<<S)-1,Xe=(1<<B)-1,Ee=d;;Ee=d){var M=y[Dn(e,d)&pe],te=M>>>4;if(d+=M&15,d>j){if(o)throw"unexpected EOF";break}if(!M)throw"invalid length/literal";if(te<256)t[h++]=te;else if(te==256){Ee=d,y=null;break}else{var Oe=te-254;if(te>264){var E=te-257,ne=Ri[E];Oe=je(e,d,(1<<ne)-1)+Pi[E],d+=ne}var ce=x[Dn(e,d)&Xe],be=ce>>>4;if(!ce)throw"invalid distance";d+=ce&15;var W=Zs[be];if(be>3){var ne=Ci[be];W+=Dn(e,d)&(1<<ne)-1,d+=ne}if(d>j){if(o)throw"unexpected EOF";break}a&&l(h+131072);for(var qe=h+Oe;h<qe;h+=4)t[h]=t[h-W],t[h+1]=t[h+1-W],t[h+2]=t[h+2-W],t[h+3]=t[h+3-W];h=qe}}n.l=y,n.p=Ee,n.b=h,y&&(u=1,n.m=S,n.d=x,n.n=B)}while(!u);return h==t.length?t:Ys(t,0,h)},Ks=new ke(0),Js=function(e){if((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(e[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function hn(e,t){return Qs((Js(e),e.subarray(2,-4)),t)}var eo=typeof TextDecoder<"u"&&new TextDecoder,to=0;try{eo.decode(Ks,{stream:!0}),to=1}catch{}const no=e=>e&&e.isCubeTexture;class ro extends en{constructor(t,n){var r,a;const o=no(t),u=((a=o?(r=t.image[0])==null?void 0:r.width:t.image.width)!=null?a:1024)/4,d=Math.floor(Math.log2(u)),h=Math.pow(2,d),y=3*Math.max(h,16*7),x=4*h,S=[o?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/y}`,`#define CUBEUV_TEXEL_HEIGHT ${1/x}`,`#define CUBEUV_MAX_MIP ${d}.0`],B=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,j=S.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${pi>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,$={map:{value:t},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},G=new ca(1,16),P=new Ze({uniforms:$,fragmentShader:j,vertexShader:B,side:Et});super(G,P)}set radius(t){this.material.uniforms.radius.value=t}get radius(){return this.material.uniforms.radius.value}set height(t){this.material.uniforms.height.value=t}get height(){return this.material.uniforms.height.value}}class io extends mi{constructor(t){super(t),this.type=Le}parse(t){const l=function(E,g){switch(E){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(g||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(g||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(g||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(g||""))}},y=`
`,x=function(E,g,H){g=g||1024;let N=E.pos,M=-1,I=0,F="",W=String.fromCharCode.apply(null,new Uint16Array(E.subarray(N,N+128)));for(;0>(M=W.indexOf(y))&&I<g&&N<E.byteLength;)F+=W,I+=W.length,N+=128,W+=String.fromCharCode.apply(null,new Uint16Array(E.subarray(N,N+128)));return-1<M?(E.pos+=I+M+1,F+W.slice(0,M)):!1},S=function(E){const g=/^#\?(\S+)/,H=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,R=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,N=/^\s*FORMAT=(\S+)\s*$/,M=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,I={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let F,W;for((E.pos>=E.byteLength||!(F=x(E)))&&l(1,"no header found"),(W=F.match(g))||l(3,"bad initial token"),I.valid|=1,I.programtype=W[1],I.string+=F+`
`;F=x(E),F!==!1;){if(I.string+=F+`
`,F.charAt(0)==="#"){I.comments+=F+`
`;continue}if((W=F.match(H))&&(I.gamma=parseFloat(W[1])),(W=F.match(R))&&(I.exposure=parseFloat(W[1])),(W=F.match(N))&&(I.valid|=2,I.format=W[1]),(W=F.match(M))&&(I.valid|=4,I.height=parseInt(W[1],10),I.width=parseInt(W[2],10)),I.valid&2&&I.valid&4)break}return I.valid&2||l(3,"missing format specifier"),I.valid&4||l(3,"missing image size specifier"),I},B=function(E,g,H){const R=g;if(R<8||R>32767||E[0]!==2||E[1]!==2||E[2]&128)return new Uint8Array(E);R!==(E[2]<<8|E[3])&&l(3,"wrong scanline width");const N=new Uint8Array(4*g*H);N.length||l(4,"unable to allocate buffer space");let M=0,I=0;const F=4*R,W=new Uint8Array(4),pe=new Uint8Array(F);let Xe=H;for(;Xe>0&&I<E.byteLength;){I+4>E.byteLength&&l(1),W[0]=E[I++],W[1]=E[I++],W[2]=E[I++],W[3]=E[I++],(W[0]!=2||W[1]!=2||(W[2]<<8|W[3])!=R)&&l(3,"bad rgbe scanline format");let Ee=0,te;for(;Ee<F&&I<E.byteLength;){te=E[I++];const ne=te>128;if(ne&&(te-=128),(te===0||Ee+te>F)&&l(3,"bad scanline data"),ne){const ce=E[I++];for(let be=0;be<te;be++)pe[Ee++]=ce}else pe.set(E.subarray(I,I+te),Ee),Ee+=te,I+=te}const Oe=R;for(let ne=0;ne<Oe;ne++){let ce=0;N[M]=pe[ne+ce],ce+=R,N[M+1]=pe[ne+ce],ce+=R,N[M+2]=pe[ne+ce],ce+=R,N[M+3]=pe[ne+ce],M+=4}Xe--}return N},j=function(E,g,H,R){const N=E[g+3],M=Math.pow(2,N-128)/255;H[R+0]=E[g+0]*M,H[R+1]=E[g+1]*M,H[R+2]=E[g+2]*M,H[R+3]=1},$=function(E,g,H,R){const N=E[g+3],M=Math.pow(2,N-128)/255;H[R+0]=St.toHalfFloat(Math.min(E[g+0]*M,65504)),H[R+1]=St.toHalfFloat(Math.min(E[g+1]*M,65504)),H[R+2]=St.toHalfFloat(Math.min(E[g+2]*M,65504)),H[R+3]=St.toHalfFloat(1)},G=new Uint8Array(t);G.pos=0;const P=S(G),U=P.width,D=P.height,X=B(G.subarray(G.pos),U,D);let Z,O,K;switch(this.type){case Ke:K=X.length/4;const E=new Float32Array(K*4);for(let H=0;H<K;H++)j(X,H*4,E,H*4);Z=E,O=Ke;break;case Le:K=X.length/4;const g=new Uint16Array(K*4);for(let H=0;H<K;H++)$(X,H*4,g,H*4);Z=g,O=Le;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:U,height:D,data:Z,header:P.string,gamma:P.gamma,exposure:P.exposure,type:O}}setDataType(t){return this.type=t,this}load(t,n,r,a){function o(l,u){switch(l.type){case Ke:case Le:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=Ie,l.magFilter=Ie,l.generateMipmaps=!1,l.flipY=!0;break}n&&n(l,u)}return super.load(t,o,r,a)}}const Vt=pi>=152;class ao extends mi{constructor(t){super(t),this.type=Le}parse(t){const g=Math.pow(2.7182818,2.2);function H(i,s){for(var c=0,f=0;f<65536;++f)(f==0||i[f>>3]&1<<(f&7))&&(s[c++]=f);for(var p=c-1;c<65536;)s[c++]=0;return p}function R(i){for(var s=0;s<16384;s++)i[s]={},i[s].len=0,i[s].lit=0,i[s].p=null}const N={l:0,c:0,lc:0};function M(i,s,c,f,p){for(;c<i;)s=s<<8|sr(f,p),c+=8;c-=i,N.l=s>>c&(1<<i)-1,N.c=s,N.lc=c}const I=new Array(59);function F(i){for(var s=0;s<=58;++s)I[s]=0;for(var s=0;s<65537;++s)I[i[s]]+=1;for(var c=0,s=58;s>0;--s){var f=c+I[s]>>1;I[s]=c,c=f}for(var s=0;s<65537;++s){var p=i[s];p>0&&(i[s]=p|I[p]++<<6)}}function W(i,s,c,f,p,m,_){for(var w=c,C=0,b=0;p<=m;p++){if(w.value-c.value>f)return!1;M(6,C,b,i,w);var A=N.l;if(C=N.c,b=N.lc,_[p]=A,A==63){if(w.value-c.value>f)throw"Something wrong with hufUnpackEncTable";M(8,C,b,i,w);var T=N.l+6;if(C=N.c,b=N.lc,p+T>m+1)throw"Something wrong with hufUnpackEncTable";for(;T--;)_[p++]=0;p--}else if(A>=59){var T=A-59+2;if(p+T>m+1)throw"Something wrong with hufUnpackEncTable";for(;T--;)_[p++]=0;p--}}F(_)}function pe(i){return i&63}function Xe(i){return i>>6}function Ee(i,s,c,f){for(;s<=c;s++){var p=Xe(i[s]),m=pe(i[s]);if(p>>m)throw"Invalid table entry";if(m>14){var _=f[p>>m-14];if(_.len)throw"Invalid table entry";if(_.lit++,_.p){var w=_.p;_.p=new Array(_.lit);for(var C=0;C<_.lit-1;++C)_.p[C]=w[C]}else _.p=new Array(1);_.p[_.lit-1]=s}else if(m)for(var b=0,C=1<<14-m;C>0;C--){var _=f[(p<<14-m)+b];if(_.len||_.p)throw"Invalid table entry";_.len=m,_.lit=s,b++}}return!0}const te={c:0,lc:0};function Oe(i,s,c,f){i=i<<8|sr(c,f),s+=8,te.c=i,te.lc=s}const ne={c:0,lc:0};function ce(i,s,c,f,p,m,_,w,C,b){if(i==s){f<8&&(Oe(c,f,p,_),c=te.c,f=te.lc),f-=8;var A=c>>f,A=new Uint8Array([A])[0];if(C.value+A>b)return!1;for(var T=w[C.value-1];A-- >0;)w[C.value++]=T}else if(C.value<b)w[C.value++]=i;else return!1;ne.c=c,ne.lc=f}function be(i){return i&65535}function qe(i){var s=be(i);return s>32767?s-65536:s}const re={a:0,b:0};function We(i,s){var c=qe(i),f=qe(s),p=f,m=c+(p&1)+(p>>1),_=m,w=m-p;re.a=_,re.b=w}function Se(i,s){var c=be(i),f=be(s),p=c-(f>>1)&65535,m=f+p-32768&65535;re.a=m,re.b=p}function rn(i,s,c,f,p,m,_){for(var w=_<16384,C=c>p?p:c,b=1,A;b<=C;)b<<=1;for(b>>=1,A=b,b>>=1;b>=1;){for(var T=0,ve=T+m*(p-A),k=m*b,V=m*A,q=f*b,Y=f*A,oe,ue,ge,Ce;T<=ve;T+=V){for(var de=T,Ye=T+f*(c-A);de<=Ye;de+=Y){var fe=de+q,xe=de+k,nt=xe+q;w?(We(i[de+s],i[xe+s]),oe=re.a,ge=re.b,We(i[fe+s],i[nt+s]),ue=re.a,Ce=re.b,We(oe,ue),i[de+s]=re.a,i[fe+s]=re.b,We(ge,Ce),i[xe+s]=re.a,i[nt+s]=re.b):(Se(i[de+s],i[xe+s]),oe=re.a,ge=re.b,Se(i[fe+s],i[nt+s]),ue=re.a,Ce=re.b,Se(oe,ue),i[de+s]=re.a,i[fe+s]=re.b,Se(ge,Ce),i[xe+s]=re.a,i[nt+s]=re.b)}if(c&b){var xe=de+k;w?We(i[de+s],i[xe+s]):Se(i[de+s],i[xe+s]),oe=re.a,i[xe+s]=re.b,i[de+s]=oe}}if(p&b)for(var de=T,Ye=T+f*(c-A);de<=Ye;de+=Y){var fe=de+q;w?We(i[de+s],i[fe+s]):Se(i[de+s],i[fe+s]),oe=re.a,i[fe+s]=re.b,i[de+s]=oe}A=b,b>>=1}return T}function Re(i,s,c,f,p,m,_,w,C,b){for(var A=0,T=0,ve=w,k=Math.trunc(p.value+(m+7)/8);p.value<k;)for(Oe(A,T,c,p),A=te.c,T=te.lc;T>=14;){var V=A>>T-14&16383,q=s[V];if(q.len)T-=q.len,ce(q.lit,_,A,T,c,f,p,C,b,ve),A=ne.c,T=ne.lc;else{if(!q.p)throw"hufDecode issues";var Y;for(Y=0;Y<q.lit;Y++){for(var oe=pe(i[q.p[Y]]);T<oe&&p.value<k;)Oe(A,T,c,p),A=te.c,T=te.lc;if(T>=oe&&Xe(i[q.p[Y]])==(A>>T-oe&(1<<oe)-1)){T-=oe,ce(q.p[Y],_,A,T,c,f,p,C,b,ve),A=ne.c,T=ne.lc;break}}if(Y==q.lit)throw"hufDecode issues"}}var ue=8-m&7;for(A>>=ue,T-=ue;T>0;){var q=s[A<<14-T&16383];if(q.len)T-=q.len,ce(q.lit,_,A,T,c,f,p,C,b,ve),A=ne.c,T=ne.lc;else throw"hufDecode issues"}return!0}function se(i,s,c,f,p,m){var _={value:0},w=c.value,C=Ae(s,c),b=Ae(s,c);c.value+=4;var A=Ae(s,c);if(c.value+=4,C<0||C>=65537||b<0||b>=65537)throw"Something wrong with HUF_ENCSIZE";var T=new Array(65537),ve=new Array(16384);R(ve);var k=f-(c.value-w);if(W(i,s,c,k,C,b,T),A>8*(f-(c.value-w)))throw"Something wrong with hufUncompress";Ee(T,C,b,ve),Re(T,ve,i,s,c,A,b,m,p,_)}function Je(i,s,c){for(var f=0;f<c;++f)s[f]=i[s[f]]}function Ne(i){for(var s=1;s<i.length;s++){var c=i[s-1]+i[s]-128;i[s]=c}}function st(i,s){for(var c=0,f=Math.floor((i.length+1)/2),p=0,m=i.length-1;!(p>m||(s[p++]=i[c++],p>m));)s[p++]=i[f++]}function mt(i){for(var s=i.byteLength,c=new Array,f=0,p=new DataView(i);s>0;){var m=p.getInt8(f++);if(m<0){var _=-m;s-=_+1;for(var w=0;w<_;w++)c.push(p.getUint8(f++))}else{var _=m;s-=2;for(var C=p.getUint8(f++),w=0;w<_+1;w++)c.push(C)}}return c}function Tn(i,s,c,f,p,m){var fe=new DataView(m.buffer),_=c[i.idx[0]].width,w=c[i.idx[0]].height,C=3,b=Math.floor(_/8),A=Math.ceil(_/8),T=Math.ceil(w/8),ve=_-(A-1)*8,k=w-(T-1)*8,V={value:0},q=new Array(C),Y=new Array(C),oe=new Array(C),ue=new Array(C),ge=new Array(C);for(let le=0;le<C;++le)ge[le]=s[i.idx[le]],q[le]=le<1?0:q[le-1]+A*T,Y[le]=new Float32Array(64),oe[le]=new Uint16Array(64),ue[le]=new Uint16Array(A*64);for(let le=0;le<T;++le){var Ce=8;le==T-1&&(Ce=k);var de=8;for(let me=0;me<A;++me){me==A-1&&(de=ve);for(let ae=0;ae<C;++ae)oe[ae].fill(0),oe[ae][0]=p[q[ae]++],et(V,f,oe[ae]),an(oe[ae],Y[ae]),At(Y[ae]);sn(Y);for(let ae=0;ae<C;++ae)bn(Y[ae],ue[ae],me*64)}let Me=0;for(let me=0;me<C;++me){const ae=c[i.idx[me]].type;for(let He=8*le;He<8*le+Ce;++He){Me=ge[me][He];for(let vt=0;vt<b;++vt){const Pe=vt*64+(He&7)*8;fe.setUint16(Me+0*2*ae,ue[me][Pe+0],!0),fe.setUint16(Me+1*2*ae,ue[me][Pe+1],!0),fe.setUint16(Me+2*2*ae,ue[me][Pe+2],!0),fe.setUint16(Me+3*2*ae,ue[me][Pe+3],!0),fe.setUint16(Me+4*2*ae,ue[me][Pe+4],!0),fe.setUint16(Me+5*2*ae,ue[me][Pe+5],!0),fe.setUint16(Me+6*2*ae,ue[me][Pe+6],!0),fe.setUint16(Me+7*2*ae,ue[me][Pe+7],!0),Me+=8*2*ae}}if(b!=A)for(let He=8*le;He<8*le+Ce;++He){const vt=ge[me][He]+8*b*2*ae,Pe=b*64+(He&7)*8;for(let ot=0;ot<de;++ot)fe.setUint16(vt+ot*2*ae,ue[me][Pe+ot],!0)}}}for(var Ye=new Uint16Array(_),fe=new DataView(m.buffer),xe=0;xe<C;++xe){c[i.idx[xe]].decoded=!0;var nt=c[i.idx[xe]].type;if(c[xe].type==2)for(var Ot=0;Ot<w;++Ot){const le=ge[xe][Ot];for(var Ue=0;Ue<_;++Ue)Ye[Ue]=fe.getUint16(le+Ue*2*nt,!0);for(var Ue=0;Ue<_;++Ue)fe.setFloat32(le+Ue*2*nt,L(Ye[Ue]),!0)}}}function et(i,s,c){for(var f,p=1;p<64;)f=s[i.value],f==65280?p=64:f>>8==255?p+=f&255:(c[p]=f,p++),i.value++}function an(i,s){s[0]=L(i[0]),s[1]=L(i[1]),s[2]=L(i[5]),s[3]=L(i[6]),s[4]=L(i[14]),s[5]=L(i[15]),s[6]=L(i[27]),s[7]=L(i[28]),s[8]=L(i[2]),s[9]=L(i[4]),s[10]=L(i[7]),s[11]=L(i[13]),s[12]=L(i[16]),s[13]=L(i[26]),s[14]=L(i[29]),s[15]=L(i[42]),s[16]=L(i[3]),s[17]=L(i[8]),s[18]=L(i[12]),s[19]=L(i[17]),s[20]=L(i[25]),s[21]=L(i[30]),s[22]=L(i[41]),s[23]=L(i[43]),s[24]=L(i[9]),s[25]=L(i[11]),s[26]=L(i[18]),s[27]=L(i[24]),s[28]=L(i[31]),s[29]=L(i[40]),s[30]=L(i[44]),s[31]=L(i[53]),s[32]=L(i[10]),s[33]=L(i[19]),s[34]=L(i[23]),s[35]=L(i[32]),s[36]=L(i[39]),s[37]=L(i[45]),s[38]=L(i[52]),s[39]=L(i[54]),s[40]=L(i[20]),s[41]=L(i[22]),s[42]=L(i[33]),s[43]=L(i[38]),s[44]=L(i[46]),s[45]=L(i[51]),s[46]=L(i[55]),s[47]=L(i[60]),s[48]=L(i[21]),s[49]=L(i[34]),s[50]=L(i[37]),s[51]=L(i[47]),s[52]=L(i[50]),s[53]=L(i[56]),s[54]=L(i[59]),s[55]=L(i[61]),s[56]=L(i[35]),s[57]=L(i[36]),s[58]=L(i[48]),s[59]=L(i[49]),s[60]=L(i[57]),s[61]=L(i[58]),s[62]=L(i[62]),s[63]=L(i[63])}function At(i){const s=.5*Math.cos(.7853975),c=.5*Math.cos(3.14159/16),f=.5*Math.cos(3.14159/8),p=.5*Math.cos(3*3.14159/16),m=.5*Math.cos(5*3.14159/16),_=.5*Math.cos(3*3.14159/8),w=.5*Math.cos(7*3.14159/16);for(var C=new Array(4),b=new Array(4),A=new Array(4),T=new Array(4),ve=0;ve<8;++ve){var k=ve*8;C[0]=f*i[k+2],C[1]=_*i[k+2],C[2]=f*i[k+6],C[3]=_*i[k+6],b[0]=c*i[k+1]+p*i[k+3]+m*i[k+5]+w*i[k+7],b[1]=p*i[k+1]-w*i[k+3]-c*i[k+5]-m*i[k+7],b[2]=m*i[k+1]-c*i[k+3]+w*i[k+5]+p*i[k+7],b[3]=w*i[k+1]-m*i[k+3]+p*i[k+5]-c*i[k+7],A[0]=s*(i[k+0]+i[k+4]),A[3]=s*(i[k+0]-i[k+4]),A[1]=C[0]+C[3],A[2]=C[1]-C[2],T[0]=A[0]+A[1],T[1]=A[3]+A[2],T[2]=A[3]-A[2],T[3]=A[0]-A[1],i[k+0]=T[0]+b[0],i[k+1]=T[1]+b[1],i[k+2]=T[2]+b[2],i[k+3]=T[3]+b[3],i[k+4]=T[3]-b[3],i[k+5]=T[2]-b[2],i[k+6]=T[1]-b[1],i[k+7]=T[0]-b[0]}for(var V=0;V<8;++V)C[0]=f*i[16+V],C[1]=_*i[16+V],C[2]=f*i[48+V],C[3]=_*i[48+V],b[0]=c*i[8+V]+p*i[24+V]+m*i[40+V]+w*i[56+V],b[1]=p*i[8+V]-w*i[24+V]-c*i[40+V]-m*i[56+V],b[2]=m*i[8+V]-c*i[24+V]+w*i[40+V]+p*i[56+V],b[3]=w*i[8+V]-m*i[24+V]+p*i[40+V]-c*i[56+V],A[0]=s*(i[V]+i[32+V]),A[3]=s*(i[V]-i[32+V]),A[1]=C[0]+C[3],A[2]=C[1]-C[2],T[0]=A[0]+A[1],T[1]=A[3]+A[2],T[2]=A[3]-A[2],T[3]=A[0]-A[1],i[0+V]=T[0]+b[0],i[8+V]=T[1]+b[1],i[16+V]=T[2]+b[2],i[24+V]=T[3]+b[3],i[32+V]=T[3]-b[3],i[40+V]=T[2]-b[2],i[48+V]=T[1]-b[1],i[56+V]=T[0]-b[0]}function sn(i){for(var s=0;s<64;++s){var c=i[0][s],f=i[1][s],p=i[2][s];i[0][s]=c+1.5747*p,i[1][s]=c-.1873*f-.4682*p,i[2][s]=c+1.8556*f}}function bn(i,s,c){for(var f=0;f<64;++f)s[c+f]=St.toHalfFloat(Rn(i[f]))}function Rn(i){return i<=1?Math.sign(i)*Math.pow(Math.abs(i),2.2):Math.sign(i)*Math.pow(g,Math.abs(i)-1)}function on(i){return new DataView(i.array.buffer,i.offset.value,i.size)}function Cn(i){var s=i.viewer.buffer.slice(i.offset.value,i.offset.value+i.size),c=new Uint8Array(mt(s)),f=new Uint8Array(c.length);return Ne(c),st(c,f),new DataView(f.buffer)}function It(i){var s=i.array.slice(i.offset.value,i.offset.value+i.size),c=hn(s),f=new Uint8Array(c.length);return Ne(c),st(c,f),new DataView(f.buffer)}function An(i){for(var s=i.viewer,c={value:i.offset.value},f=new Uint16Array(i.width*i.scanlineBlockSize*(i.channels*i.type)),p=new Uint8Array(8192),m=0,_=new Array(i.channels),w=0;w<i.channels;w++)_[w]={},_[w].start=m,_[w].end=_[w].start,_[w].nx=i.width,_[w].ny=i.lines,_[w].size=i.type,m+=_[w].nx*_[w].ny*_[w].size;var C=Dt(s,c),b=Dt(s,c);if(b>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(C<=b)for(var w=0;w<b-C+1;w++)p[w+C]=yt(s,c);var A=new Uint16Array(65536),T=H(p,A),ve=Ae(s,c);se(i.array,s,c,ve,f,m);for(var w=0;w<i.channels;++w)for(var k=_[w],V=0;V<_[w].size;++V)rn(f,k.start+V,k.nx,k.size,k.ny,k.nx*k.size,T);Je(A,f,m);for(var q=0,Y=new Uint8Array(f.buffer.byteLength),oe=0;oe<i.lines;oe++)for(var ue=0;ue<i.channels;ue++){var k=_[ue],ge=k.nx*k.size,Ce=new Uint8Array(f.buffer,k.end*2,ge*2);Y.set(Ce,q),q+=ge*2,k.end+=ge}return new DataView(Y.buffer)}function tt(i){var s=i.array.slice(i.offset.value,i.offset.value+i.size),c=hn(s);const f=i.lines*i.channels*i.width,p=i.type==1?new Uint16Array(f):new Uint32Array(f);let m=0,_=0;const w=new Array(4);for(let C=0;C<i.lines;C++)for(let b=0;b<i.channels;b++){let A=0;switch(i.type){case 1:w[0]=m,w[1]=w[0]+i.width,m=w[1]+i.width;for(let T=0;T<i.width;++T){const ve=c[w[0]++]<<8|c[w[1]++];A+=ve,p[_]=A,_++}break;case 2:w[0]=m,w[1]=w[0]+i.width,w[2]=w[1]+i.width,m=w[2]+i.width;for(let T=0;T<i.width;++T){const ve=c[w[0]++]<<24|c[w[1]++]<<16|c[w[2]++]<<8;A+=ve,p[_]=A,_++}break}}return new DataView(p.buffer)}function ar(i){var s=i.viewer,c={value:i.offset.value},f=new Uint8Array(i.width*i.lines*(i.channels*i.type*2)),p={version:Fe(s,c),unknownUncompressedSize:Fe(s,c),unknownCompressedSize:Fe(s,c),acCompressedSize:Fe(s,c),dcCompressedSize:Fe(s,c),rleCompressedSize:Fe(s,c),rleUncompressedSize:Fe(s,c),rleRawSize:Fe(s,c),totalAcUncompressedCount:Fe(s,c),totalDcUncompressedCount:Fe(s,c),acCompression:Fe(s,c)};if(p.version<2)throw"EXRLoader.parse: "+Bt.compression+" version "+p.version+" is unsupported";for(var m=new Array,_=Dt(s,c)-2;_>0;){var w=ln(s.buffer,c),C=yt(s,c),b=C>>2&3,A=(C>>4)-1,T=new Int8Array([A])[0],ve=yt(s,c);m.push({name:w,index:T,type:ve,compression:b}),_-=w.length+3}for(var k=Bt.channels,V=new Array(i.channels),q=0;q<i.channels;++q){var Y=V[q]={},oe=k[q];Y.name=oe.name,Y.compression=0,Y.decoded=!1,Y.type=oe.pixelType,Y.pLinear=oe.pLinear,Y.width=i.width,Y.height=i.lines}for(var ue={idx:new Array(3)},ge=0;ge<i.channels;++ge)for(var Y=V[ge],q=0;q<m.length;++q){var Ce=m[q];Y.name==Ce.name&&(Y.compression=Ce.compression,Ce.index>=0&&(ue.idx[Ce.index]=ge),Y.offset=ge)}if(p.acCompressedSize>0)switch(p.acCompression){case 0:var fe=new Uint16Array(p.totalAcUncompressedCount);se(i.array,s,c,p.acCompressedSize,fe,p.totalAcUncompressedCount);break;case 1:var de=i.array.slice(c.value,c.value+p.totalAcUncompressedCount),Ye=hn(de),fe=new Uint16Array(Ye.buffer);c.value+=p.totalAcUncompressedCount;break}if(p.dcCompressedSize>0){var xe={array:i.array,offset:c,size:p.dcCompressedSize},nt=new Uint16Array(It(xe).buffer);c.value+=p.dcCompressedSize}if(p.rleRawSize>0){var de=i.array.slice(c.value,c.value+p.rleCompressedSize),Ye=hn(de),Ot=mt(Ye.buffer);c.value+=p.rleCompressedSize}for(var Ue=0,le=new Array(V.length),q=0;q<le.length;++q)le[q]=new Array;for(var Me=0;Me<i.lines;++Me)for(var me=0;me<V.length;++me)le[me].push(Ue),Ue+=V[me].width*i.type*2;Tn(ue,le,V,fe,nt,f);for(var q=0;q<V.length;++q){var Y=V[q];if(!Y.decoded)switch(Y.compression){case 2:for(var ae=0,He=0,Me=0;Me<i.lines;++Me){for(var vt=le[q][ae],Pe=0;Pe<Y.width;++Pe){for(var ot=0;ot<2*Y.type;++ot)f[vt++]=Ot[He+ot*Y.width*Y.height];He++}ae++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(f.buffer)}function ln(i,s){for(var c=new Uint8Array(i),f=0;c[s.value+f]!=0;)f+=1;var p=new TextDecoder().decode(c.slice(s.value,s.value+f));return s.value=s.value+f+1,p}function Wi(i,s,c){var f=new TextDecoder().decode(new Uint8Array(i).slice(s.value,s.value+c));return s.value=s.value+c,f}function Vi(i,s){var c=Pt(i,s),f=Ae(i,s);return[c,f]}function ji(i,s){var c=Ae(i,s),f=Ae(i,s);return[c,f]}function Pt(i,s){var c=i.getInt32(s.value,!0);return s.value=s.value+4,c}function Ae(i,s){var c=i.getUint32(s.value,!0);return s.value=s.value+4,c}function sr(i,s){var c=i[s.value];return s.value=s.value+1,c}function yt(i,s){var c=i.getUint8(s.value);return s.value=s.value+1,c}const Fe=function(i,s){let c;return"getBigInt64"in DataView.prototype?c=Number(i.getBigInt64(s.value,!0)):c=i.getUint32(s.value+4,!0)+Number(i.getUint32(s.value,!0)<<32),s.value+=8,c};function _e(i,s){var c=i.getFloat32(s.value,!0);return s.value+=4,c}function Zi(i,s){return St.toHalfFloat(_e(i,s))}function L(i){var s=(i&31744)>>10,c=i&1023;return(i>>15?-1:1)*(s?s===31?c?NaN:1/0:Math.pow(2,s-15)*(1+c/1024):6103515625e-14*(c/1024))}function Dt(i,s){var c=i.getUint16(s.value,!0);return s.value+=2,c}function $i(i,s){return L(Dt(i,s))}function Xi(i,s,c,f){for(var p=c.value,m=[];c.value<p+f-1;){var _=ln(s,c),w=Pt(i,c),C=yt(i,c);c.value+=3;var b=Pt(i,c),A=Pt(i,c);m.push({name:_,pixelType:w,pLinear:C,xSampling:b,ySampling:A})}return c.value+=1,m}function qi(i,s){var c=_e(i,s),f=_e(i,s),p=_e(i,s),m=_e(i,s),_=_e(i,s),w=_e(i,s),C=_e(i,s),b=_e(i,s);return{redX:c,redY:f,greenX:p,greenY:m,blueX:_,blueY:w,whiteX:C,whiteY:b}}function Yi(i,s){var c=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],f=yt(i,s);return c[f]}function Qi(i,s){var c=Ae(i,s),f=Ae(i,s),p=Ae(i,s),m=Ae(i,s);return{xMin:c,yMin:f,xMax:p,yMax:m}}function Ki(i,s){var c=["INCREASING_Y"],f=yt(i,s);return c[f]}function Ji(i,s){var c=_e(i,s),f=_e(i,s);return[c,f]}function ea(i,s){var c=_e(i,s),f=_e(i,s),p=_e(i,s);return[c,f,p]}function ta(i,s,c,f,p){if(f==="string"||f==="stringvector"||f==="iccProfile")return Wi(s,c,p);if(f==="chlist")return Xi(i,s,c,p);if(f==="chromaticities")return qi(i,c);if(f==="compression")return Yi(i,c);if(f==="box2i")return Qi(i,c);if(f==="lineOrder")return Ki(i,c);if(f==="float")return _e(i,c);if(f==="v2f")return Ji(i,c);if(f==="v3f")return ea(i,c);if(f==="int")return Pt(i,c);if(f==="rational")return Vi(i,c);if(f==="timecode")return ji(i,c);if(f==="preview")return c.value+=p,"skipped";c.value+=p}function na(i,s,c){const f={};if(i.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";f.version=i.getUint8(4);const p=i.getUint8(5);f.spec={singleTile:!!(p&2),longName:!!(p&4),deepFormat:!!(p&8),multiPart:!!(p&16)},c.value=8;for(var m=!0;m;){var _=ln(s,c);if(_==0)m=!1;else{var w=ln(s,c),C=Ae(i,c),b=ta(i,s,c,w,C);b===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${w}'.`):f[_]=b}}if(p&-5)throw console.error("EXRHeader:",f),"THREE.EXRLoader: provided file is currently unsupported.";return f}function ra(i,s,c,f,p){const m={size:0,viewer:s,array:c,offset:f,width:i.dataWindow.xMax-i.dataWindow.xMin+1,height:i.dataWindow.yMax-i.dataWindow.yMin+1,channels:i.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:i.channels[0].pixelType,uncompress:null,getter:null,format:null,[Vt?"colorSpace":"encoding"]:null};switch(i.compression){case"NO_COMPRESSION":m.lines=1,m.uncompress=on;break;case"RLE_COMPRESSION":m.lines=1,m.uncompress=Cn;break;case"ZIPS_COMPRESSION":m.lines=1,m.uncompress=It;break;case"ZIP_COMPRESSION":m.lines=16,m.uncompress=It;break;case"PIZ_COMPRESSION":m.lines=32,m.uncompress=An;break;case"PXR24_COMPRESSION":m.lines=16,m.uncompress=tt;break;case"DWAA_COMPRESSION":m.lines=32,m.uncompress=ar;break;case"DWAB_COMPRESSION":m.lines=256,m.uncompress=ar;break;default:throw"EXRLoader.parse: "+i.compression+" is unsupported"}if(m.scanlineBlockSize=m.lines,m.type==1)switch(p){case Ke:m.getter=$i,m.inputSize=2;break;case Le:m.getter=Dt,m.inputSize=2;break}else if(m.type==2)switch(p){case Ke:m.getter=_e,m.inputSize=4;break;case Le:m.getter=Zi,m.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+m.type+" for "+i.compression+".";m.blockCount=(i.dataWindow.yMax+1)/m.scanlineBlockSize;for(var _=0;_<m.blockCount;_++)Fe(s,f);m.outputChannels=m.channels==3?4:m.channels;const w=m.width*m.height*m.outputChannels;switch(p){case Ke:m.byteArray=new Float32Array(w),m.channels<m.outputChannels&&m.byteArray.fill(1,0,w);break;case Le:m.byteArray=new Uint16Array(w),m.channels<m.outputChannels&&m.byteArray.fill(15360,0,w);break;default:console.error("THREE.EXRLoader: unsupported type: ",p);break}return m.bytesPerLine=m.width*m.inputSize*m.channels,m.outputChannels==4?m.format=Yt:m.format=ua,Vt?m.colorSpace="srgb-linear":m.encoding=3e3,m}const cn=new DataView(t),ia=new Uint8Array(t),Lt={value:0},Bt=na(cn,t,Lt),J=ra(Bt,cn,ia,Lt,this.type),or={value:0},aa={R:0,G:1,B:2,A:3,Y:0};for(let i=0;i<J.height/J.scanlineBlockSize;i++){const s=Ae(cn,Lt);J.size=Ae(cn,Lt),J.lines=s+J.scanlineBlockSize>J.height?J.height-s:J.scanlineBlockSize;const f=J.size<J.lines*J.bytesPerLine?J.uncompress(J):on(J);Lt.value+=J.size;for(let p=0;p<J.scanlineBlockSize;p++){const m=p+i*J.scanlineBlockSize;if(m>=J.height)break;for(let _=0;_<J.channels;_++){const w=aa[Bt.channels[_].name];for(let C=0;C<J.width;C++){or.value=(p*(J.channels*J.width)+_*J.width+C)*J.inputSize;const b=(J.height-1-m)*(J.width*J.outputChannels)+C*J.outputChannels+w;J.byteArray[b]=J.getter(f,or)}}}}return{header:Bt,width:J.width,height:J.height,data:J.byteArray,format:J.format,[Vt?"colorSpace":"encoding"]:J[Vt?"colorSpace":"encoding"],type:this.type}}setDataType(t){return this.type=t,this}load(t,n,r,a){function o(l,u){Vt?l.colorSpace=u.colorSpace:l.encoding=u.encoding,l.minFilter=Ie,l.magFilter=Ie,l.generateMipmaps=!1,l.flipY=!1,n&&n(l,u)}return super.load(t,o,r,a)}}function so(e,t,...n){const r=v.useRef(),a=Ge(o=>o.scene);return v.useLayoutEffect(()=>{let o;if(e&&e!=null&&e.current&&t&&(r.current=o=new t(e.current,...n)),o)return o.traverse(l=>l.raycast=()=>null),a.add(o),()=>{r.current=void 0,a.remove(o),o.dispose==null||o.dispose()}},[a,t,e,...n]),pt(()=>{var o;return void((o=r.current)==null||o.update==null?void 0:o.update())}),r}function oo(e,t){const n=v.useRef(),[r]=v.useState(()=>t?t instanceof Fn?{current:t}:t:n),[a]=v.useState(()=>new da(void 0));v.useLayoutEffect(()=>{t&&(r.current=t instanceof Fn?t:t.current),a._root=r.current});const o=v.useRef({}),l=v.useMemo(()=>{const u={};return e.forEach(d=>Object.defineProperty(u,d.name,{enumerable:!0,get(){if(r.current)return o.current[d.name]||(o.current[d.name]=a.clipAction(d,r.current))},configurable:!0})),{ref:r,clips:e,actions:u,names:e.map(d=>d.name),mixer:a}},[e]);return pt((u,d)=>a.update(d)),v.useEffect(()=>{const u=r.current;return()=>{o.current={},a.stopAllAction(),Object.values(l.actions).forEach(d=>{u&&a.uncacheAction(d,u)})}},[e]),l}const lo=3e3,co=3001,Li=(e,t,n)=>{let r;switch(e){case ht:r=new Uint8ClampedArray(t*n*4);break;case Le:r=new Uint16Array(t*n*4);break;case gi:r=new Uint32Array(t*n*4);break;case va:r=new Int8Array(t*n*4);break;case ma:r=new Int16Array(t*n*4);break;case pa:r=new Int32Array(t*n*4);break;case Ke:r=new Float32Array(t*n*4);break;default:throw new Error("Unsupported data type")}return r};let pn;const uo=(e,t,n,r)=>{if(pn!==void 0)return pn;const a=new $e(1,1,r);t.setRenderTarget(a);const o=new en(new vi,new yi({color:16777215}));t.render(o,n),t.setRenderTarget(null);const l=Li(e,a.width,a.height);return t.readRenderTargetPixels(a,0,0,a.width,a.height,l),a.dispose(),o.geometry.dispose(),o.material.dispose(),pn=l[0]!==0,pn};class Qn{constructor(t){var n,r,a,o,l,u,d,h,y,x,S,B,j,$,G,P;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(D){throw this._renderer.setRenderTarget(null),D}this._renderer.setRenderTarget(null)},this._width=t.width,this._height=t.height,this._type=t.type,this._colorSpace=t.colorSpace;const U={format:Yt,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=t.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy)!==void 0?(r=t.renderTargetOptions)===null||r===void 0?void 0:r.anisotropy:1,generateMipmaps:((a=t.renderTargetOptions)===null||a===void 0?void 0:a.generateMipmaps)!==void 0?(o=t.renderTargetOptions)===null||o===void 0?void 0:o.generateMipmaps:!1,magFilter:((l=t.renderTargetOptions)===null||l===void 0?void 0:l.magFilter)!==void 0?(u=t.renderTargetOptions)===null||u===void 0?void 0:u.magFilter:Ie,minFilter:((d=t.renderTargetOptions)===null||d===void 0?void 0:d.minFilter)!==void 0?(h=t.renderTargetOptions)===null||h===void 0?void 0:h.minFilter:Ie,samples:((y=t.renderTargetOptions)===null||y===void 0?void 0:y.samples)!==void 0?(x=t.renderTargetOptions)===null||x===void 0?void 0:x.samples:void 0,wrapS:((S=t.renderTargetOptions)===null||S===void 0?void 0:S.wrapS)!==void 0?(B=t.renderTargetOptions)===null||B===void 0?void 0:B.wrapS:ut,wrapT:((j=t.renderTargetOptions)===null||j===void 0?void 0:j.wrapT)!==void 0?($=t.renderTargetOptions)===null||$===void 0?void 0:$.wrapT:ut};if(this._material=t.material,t.renderer?this._renderer=t.renderer:(this._renderer=Qn.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new yn,this._camera=new jn,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!uo(this._type,this._renderer,this._camera,U)){let D;switch(this._type){case Le:D=this._renderer.extensions.has("EXT_color_buffer_float")?Ke:void 0;break}D!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ke}`),this._type=D):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new en(new vi,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new $e(this.width,this.height,U),this._renderTarget.texture.mapping=((G=t.renderTargetOptions)===null||G===void 0?void 0:G.mapping)!==void 0?(P=t.renderTargetOptions)===null||P===void 0?void 0:P.mapping:xn}static instantiateRenderer(){const t=new fa;return t.setSize(128,128),t}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const t=Li(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,t),t}toDataTexture(t){const n=new ha(this.toArray(),this.width,this.height,Yt,this._type,(t==null?void 0:t.mapping)||xn,(t==null?void 0:t.wrapS)||ut,(t==null?void 0:t.wrapT)||ut,(t==null?void 0:t.magFilter)||Ie,(t==null?void 0:t.minFilter)||Ie,(t==null?void 0:t.anisotropy)||1,Qt);return n.generateMipmaps=(t==null?void 0:t.generateMipmaps)!==void 0?t==null?void 0:t.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(t){this.disposeOnDemandRenderer(),t&&this.renderTarget.dispose(),this.material instanceof Ze&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof dt&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof dt&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(t){this._width=t,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(t){this._height=t,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(t){this._renderTarget=t,this._width=t.width,this._height=t.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const fo=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,ho=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class po extends Ze{constructor({gamma:t,offsetHdr:n,offsetSdr:r,gainMapMin:a,gainMapMax:o,maxDisplayBoost:l,hdrCapacityMin:u,hdrCapacityMax:d,sdr:h,gainMap:y}){super({name:"GainMapDecoderMaterial",vertexShader:fo,fragmentShader:ho,uniforms:{sdr:{value:h},gainMap:{value:y},gamma:{value:new we(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new we().fromArray(n)},offsetSdr:{value:new we().fromArray(r)},gainMapMin:{value:new we().fromArray(a)},gainMapMax:{value:new we().fromArray(o)},weightFactor:{value:(Math.log2(l)-u)/(d-u)}},blending:Rt,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=l,this._hdrCapacityMin=u,this._hdrCapacityMax=d,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const n=this.uniforms.gamma.value;n.x=1/t[0],n.y=1/t[1],n.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class Bi extends Error{}class Oi extends Error{}const jt=(e,t,n)=>{const r=new RegExp(`${t}="([^"]*)"`,"i").exec(e);if(r)return r[1];const a=new RegExp(`<${t}[^>]*>([\\s\\S]*?)</${t}>`,"i").exec(e);if(a){const o=a[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return o&&o.length===3?o.map(l=>l.replace(/<\/?rdf:li>/g,"")):a[1].trim()}if(n!==void 0)return n;throw new Error(`Can't find ${t} in gainmap metadata`)},mo=e=>{let t;typeof TextDecoder<"u"?t=new TextDecoder().decode(e):t=e.toString();let n=t.indexOf("<x:xmpmeta");for(;n!==-1;){const r=t.indexOf("x:xmpmeta>",n),a=t.slice(n,r+10);try{const o=jt(a,"hdrgm:GainMapMin","0"),l=jt(a,"hdrgm:GainMapMax"),u=jt(a,"hdrgm:Gamma","1"),d=jt(a,"hdrgm:OffsetSDR","0.015625"),h=jt(a,"hdrgm:OffsetHDR","0.015625"),y=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(a),x=y?y[1]:"0",S=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(a);if(!S)throw new Error("Incomplete gainmap metadata");const B=S[1];return{gainMapMin:Array.isArray(o)?o.map(j=>parseFloat(j)):[parseFloat(o),parseFloat(o),parseFloat(o)],gainMapMax:Array.isArray(l)?l.map(j=>parseFloat(j)):[parseFloat(l),parseFloat(l),parseFloat(l)],gamma:Array.isArray(u)?u.map(j=>parseFloat(j)):[parseFloat(u),parseFloat(u),parseFloat(u)],offsetSdr:Array.isArray(d)?d.map(j=>parseFloat(j)):[parseFloat(d),parseFloat(d),parseFloat(d)],offsetHdr:Array.isArray(h)?h.map(j=>parseFloat(j)):[parseFloat(h),parseFloat(h),parseFloat(h)],hdrCapacityMin:parseFloat(x),hdrCapacityMax:parseFloat(B)}}catch{}n=t.indexOf("<x:xmpmeta",r)}};class vo{constructor(t){this.options={debug:t&&t.debug!==void 0?t.debug:!1,extractFII:t&&t.extractFII!==void 0?t.extractFII:!0,extractNonFII:t&&t.extractNonFII!==void 0?t.extractNonFII:!0}}extract(t){return new Promise((n,r)=>{const a=this.options.debug,o=new DataView(t.buffer);if(o.getUint16(0)!==65496){r(new Error("Not a valid jpeg"));return}const l=o.byteLength;let u=2,d=0,h;for(;u<l;){if(++d>250){r(new Error(`Found no marker after ${d} loops `));return}if(o.getUint8(u)!==255){r(new Error(`Not a valid marker at offset 0x${u.toString(16)}, found: 0x${o.getUint8(u).toString(16)}`));return}if(h=o.getUint8(u+1),a&&console.log(`Marker: ${h.toString(16)}`),h===226){a&&console.log("Found APP2 marker (0xffe2)");const y=u+4;if(o.getUint32(y)===1297106432){const x=y+4;let S;if(o.getUint16(x)===18761)S=!1;else if(o.getUint16(x)===19789)S=!0;else{r(new Error("No valid endianness marker found in TIFF header"));return}if(o.getUint16(x+2,!S)!==42){r(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const B=o.getUint32(x+4,!S);if(B<8){r(new Error("Not valid TIFF data! (First offset less than 8)"));return}const j=x+B,$=o.getUint16(j,!S),G=j+2;let P=0;for(let Z=G;Z<G+12*$;Z+=12)o.getUint16(Z,!S)===45057&&(P=o.getUint32(Z+8,!S));const D=j+2+$*12+4,X=[];for(let Z=D;Z<D+P*16;Z+=16){const O={MPType:o.getUint32(Z,!S),size:o.getUint32(Z+4,!S),dataOffset:o.getUint32(Z+8,!S),dependantImages:o.getUint32(Z+12,!S),start:-1,end:-1,isFII:!1};O.dataOffset?(O.start=x+O.dataOffset,O.isFII=!1):(O.start=0,O.isFII=!0),O.end=O.start+O.size,X.push(O)}if(this.options.extractNonFII&&X.length){const Z=new Blob([o]),O=[];for(const K of X){if(K.isFII&&!this.options.extractFII)continue;const E=Z.slice(K.start,K.end+1,"image/jpeg");O.push(E)}n(O)}}}u+=2+o.getUint16(u+2)}})}}const go=async e=>{const t=mo(e);if(!t)throw new Oi("Gain map XMP metadata not found");const r=await new vo({extractFII:!0,extractNonFII:!0}).extract(e);if(r.length!==2)throw new Bi("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:t}},Qr=e=>new Promise((t,n)=>{const r=document.createElement("img");r.onload=()=>{t(r)},r.onerror=a=>{n(a)},r.src=URL.createObjectURL(e)});class Ni extends ga{constructor(t,n){super(n),t&&(this._renderer=t),this._internalLoadingManager=new ya}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=new po({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new dt,sdr:new dt});return new Qn({width:16,height:16,type:Le,colorSpace:Qt,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(t,n,r,a){const o=a?new Blob([a],{type:"image/jpeg"}):void 0,l=new Blob([r],{type:"image/jpeg"});let u,d,h=!1;if(typeof createImageBitmap>"u"){const S=await Promise.all([o?Qr(o):Promise.resolve(void 0),Qr(l)]);d=S[0],u=S[1],h=!0}else{const S=await Promise.all([o?createImageBitmap(o,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(l,{imageOrientation:"flipY"})]);d=S[0],u=S[1]}const y=new dt(d||new ImageData(2,2),xn,ut,ut,Ie,lr,Yt,ht,1,Qt);y.flipY=h,y.needsUpdate=!0;const x=new dt(u,xn,ut,ut,Ie,lr,Yt,ht,1,Qe);x.flipY=h,x.needsUpdate=!0,t.width=u.width,t.height=u.height,t.material.gainMap=y,t.material.sdr=x,t.material.gainMapMin=n.gainMapMin,t.material.gainMapMax=n.gainMapMax,t.material.offsetHdr=n.offsetHdr,t.material.offsetSdr=n.offsetSdr,t.material.gamma=n.gamma,t.material.hdrCapacityMin=n.hdrCapacityMin,t.material.hdrCapacityMax=n.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,n.hdrCapacityMax),t.material.needsUpdate=!0,t.render()}}class yo extends Ni{load([t,n,r],a,o,l){const u=this.prepareQuadRenderer();let d,h,y;const x=async()=>{if(d&&h&&y){try{await this.render(u,y,d,h)}catch(g){this.manager.itemError(t),this.manager.itemError(n),this.manager.itemError(r),typeof l=="function"&&l(g),u.disposeOnDemandRenderer();return}typeof a=="function"&&a(u),this.manager.itemEnd(t),this.manager.itemEnd(n),this.manager.itemEnd(r),u.disposeOnDemandRenderer()}};let S=!0,B=0,j=0,$=!0,G=0,P=0,U=!0,D=0,X=0;const Z=()=>{if(typeof o=="function"){const g=B+G+D,H=j+P+X,R=S&&$&&U;o(new ProgressEvent("progress",{lengthComputable:R,loaded:H,total:g}))}};this.manager.itemStart(t),this.manager.itemStart(n),this.manager.itemStart(r);const O=new vn(this._internalLoadingManager);O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(this.withCredentials),O.load(t,async g=>{if(typeof g=="string")throw new Error("Invalid sdr buffer");d=g,await x()},g=>{S=g.lengthComputable,j=g.loaded,B=g.total,Z()},g=>{this.manager.itemError(t),typeof l=="function"&&l(g)});const K=new vn(this._internalLoadingManager);K.setResponseType("arraybuffer"),K.setRequestHeader(this.requestHeader),K.setPath(this.path),K.setWithCredentials(this.withCredentials),K.load(n,async g=>{if(typeof g=="string")throw new Error("Invalid gainmap buffer");h=g,await x()},g=>{$=g.lengthComputable,P=g.loaded,G=g.total,Z()},g=>{this.manager.itemError(n),typeof l=="function"&&l(g)});const E=new vn(this._internalLoadingManager);return E.setRequestHeader(this.requestHeader),E.setPath(this.path),E.setWithCredentials(this.withCredentials),E.load(r,async g=>{if(typeof g!="string")throw new Error("Invalid metadata string");y=JSON.parse(g),await x()},g=>{U=g.lengthComputable,X=g.loaded,D=g.total,Z()},g=>{this.manager.itemError(r),typeof l=="function"&&l(g)}),u}}class xo extends Ni{load(t,n,r,a){const o=this.prepareQuadRenderer(),l=new vn(this._internalLoadingManager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(this.withCredentials),this.manager.itemStart(t),l.load(t,async u=>{if(typeof u=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const d=new Uint8Array(u);let h,y,x;try{const S=await go(d);h=S.sdr,y=S.gainMap,x=S.metadata}catch(S){if(S instanceof Oi||S instanceof Bi)console.warn(`Failure to reconstruct an HDR image from ${t}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),x={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},h=d;else throw S}try{await this.render(o,x,h,y)}catch(S){this.manager.itemError(t),typeof a=="function"&&a(S),o.disposeOnDemandRenderer();return}typeof n=="function"&&n(o),this.manager.itemEnd(t),o.disposeOnDemandRenderer()},r,u=>{this.manager.itemError(t),typeof a=="function"&&a(u)}),o}}const Kt={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},Fi="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Mt=e=>Array.isArray(e),Kn=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Mn({files:e=Kn,path:t="",preset:n=void 0,encoding:r=void 0,extensions:a}={}){let o=null,l=!1;n&&(Jn(n),e=Kt[n],t=Fi),l=Mt(e);const{extension:u,isCubemap:d}=er(e);if(o=tr(u),!o)throw new Error("useEnvironment: Unrecognized file extension: "+e);const h=Ge(B=>B.gl);v.useLayoutEffect(()=>{if(u!=="webp"&&u!=="jpg"&&u!=="jpeg")return;function B(){wn.clear(o,l?[e]:e)}h.domElement.addEventListener("webglcontextlost",B,{once:!0})},[e,h.domElement]);const y=wn(o,l?[e]:e,B=>{(u==="webp"||u==="jpg"||u==="jpeg")&&B.setRenderer(h),B.setPath==null||B.setPath(t),a&&a(B)});let x=l?y[0]:y;if(u==="jpg"||u==="jpeg"||u==="webp"){var S;x=(S=x.renderTarget)==null?void 0:S.texture}return x.mapping=d?xa:wa,"colorSpace"in x?x.colorSpace=r??d?"srgb":"srgb-linear":x.encoding=r??d?co:lo,x}const wo={files:Kn,path:"",preset:void 0,extensions:void 0};Mn.preload=e=>{const t={...wo,...e};let{files:n,path:r=""}=t;const{preset:a,extensions:o}=t;a&&(Jn(a),n=Kt[a],r=Fi);const{extension:l}=er(n);if(l==="webp"||l==="jpg"||l==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const u=tr(l);if(!u)throw new Error("useEnvironment: Unrecognized file extension: "+n);wn.preload(u,Mt(n)?[n]:n,d=>{d.setPath==null||d.setPath(r),o&&o(d)})};const Eo={files:Kn,preset:void 0};Mn.clear=e=>{const t={...Eo,...e};let{files:n}=t;const{preset:r}=t;r&&(Jn(r),n=Kt[r]);const{extension:a}=er(n),o=tr(a);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+n);wn.clear(o,Mt(n)?[n]:n)};function Jn(e){if(!(e in Kt))throw new Error("Preset must be one of: "+Object.keys(Kt).join(", "))}function er(e){var t;const n=Mt(e)&&e.length===6,r=Mt(e)&&e.length===3&&e.some(l=>l.endsWith("json")),a=Mt(e)?e[0]:e;return{extension:n?"cube":r?"webp":a.startsWith("data:application/exr")?"exr":a.startsWith("data:application/hdr")?"hdr":a.startsWith("data:image/jpeg")?"jpg":(t=a.split(".").pop())==null||(t=t.split("?"))==null||(t=t.shift())==null?void 0:t.toLowerCase(),isCubemap:n,isGainmap:r}}function tr(e){return e==="cube"?Ea:e==="hdr"?io:e==="exr"?ao:e==="jpg"||e==="jpeg"?xo:e==="webp"?yo:null}const So=e=>e.current&&e.current.isScene,_o=e=>So(e)?e.current:e;function nr(e,t,n,r,a={}){var o,l,u,d;a={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...a};const h=_o(t||n),y=h.background,x=h.environment,S={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(o=(l=h.backgroundRotation)==null||l.clone==null?void 0:l.clone())!==null&&o!==void 0?o:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(u=(d=h.environmentRotation)==null||d.clone==null?void 0:d.clone())!==null&&u!==void 0?u:[0,0,0]};return e!=="only"&&(h.environment=r),e&&(h.background=r),cr(h,a),()=>{e!=="only"&&(h.environment=x),e&&(h.background=y),cr(h,S)}}function rr({scene:e,background:t=!1,map:n,...r}){const a=Ge(o=>o.scene);return v.useLayoutEffect(()=>{if(n)return nr(t,e,a,n,r)}),null}function Ui({background:e=!1,scene:t,blur:n,backgroundBlurriness:r,backgroundIntensity:a,backgroundRotation:o,environmentIntensity:l,environmentRotation:u,...d}){const h=Mn(d),y=Ge(x=>x.scene);return v.useLayoutEffect(()=>nr(e,t,y,h,{backgroundBlurriness:n??r,backgroundIntensity:a,backgroundRotation:o,environmentIntensity:l,environmentRotation:u})),v.useEffect(()=>()=>{h.dispose()},[h]),null}function Mo({children:e,near:t=.1,far:n=1e3,resolution:r=256,frames:a=1,map:o,background:l=!1,blur:u,backgroundBlurriness:d,backgroundIntensity:h,backgroundRotation:y,environmentIntensity:x,environmentRotation:S,scene:B,files:j,path:$,preset:G=void 0,extensions:P}){const U=Ge(E=>E.gl),D=Ge(E=>E.scene),X=v.useRef(null),[Z]=v.useState(()=>new yn),O=v.useMemo(()=>{const E=new Sa(r);return E.texture.type=Le,E},[r]);v.useEffect(()=>()=>{O.dispose()},[O]),v.useLayoutEffect(()=>{if(a===1){const E=U.autoClear;U.autoClear=!0,X.current.update(U,Z),U.autoClear=E}return nr(l,B,D,O.texture,{backgroundBlurriness:u??d,backgroundIntensity:h,backgroundRotation:y,environmentIntensity:x,environmentRotation:S})},[e,Z,O.texture,B,D,l,a,U]);let K=1;return pt(()=>{if(a===1/0||K<a){const E=U.autoClear;U.autoClear=!0,X.current.update(U,Z),U.autoClear=E,K++}}),v.createElement(v.Fragment,null,_a(v.createElement(v.Fragment,null,e,v.createElement("cubeCamera",{ref:X,args:[t,n,O]}),j||G?v.createElement(Ui,{background:!0,files:j,preset:G,path:$,extensions:P}):o?v.createElement(rr,{background:!0,map:o,extensions:P}):null),Z))}function To(e){var t,n,r,a;const o=Mn(e),l=e.map||o;v.useMemo(()=>$n({GroundProjectedEnvImpl:ro}),[]),v.useEffect(()=>()=>{o.dispose()},[o]);const u=v.useMemo(()=>[l],[l]),d=(t=e.ground)==null?void 0:t.height,h=(n=e.ground)==null?void 0:n.radius,y=(r=(a=e.ground)==null?void 0:a.scale)!==null&&r!==void 0?r:1e3;return v.createElement(v.Fragment,null,v.createElement(rr,ui({},e,{map:l})),v.createElement("groundProjectedEnvImpl",{args:u,scale:y,height:d,radius:h}))}function bo(e){return e.ground?v.createElement(To,e):e.map?v.createElement(rr,e):e.children?v.createElement(Mo,e):v.createElement(Ui,e)}/**
 * postprocessing v6.36.6 build Tue Dec 31 2024
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2024 Raoul van Rschen
 * @license Zlib
 */var Ln=1/1e3,Ro=1e3,Co=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(e){typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}get delta(){return this._delta*Ln}get fixedDelta(){return this._fixedDelta*Ln}set fixedDelta(e){this._fixedDelta=e*Ro}get elapsed(){return this._elapsed*Ln}update(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(e!==void 0?e:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(e){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},Ao=(()=>{const e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]),n=new Ei;return n.setAttribute("position",new ur(e,3)),n.setAttribute("uv",new ur(t,2)),n})(),Be=class Wn{static get fullscreenGeometry(){return Ao}constructor(t="Pass",n=new yn,r=new Ca){this.name=t,this.renderer=null,this.scene=n,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!t}}set mainScene(t){}set mainCamera(t){}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let n=this.screen;n!==null?n.material=t:(n=new en(Wn.fullscreenGeometry,t),n.frustumCulled=!1,this.scene===null&&(this.scene=new yn),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,n=Ct){}render(t,n,r,a,o){throw new Error("Render method not implemented!")}setSize(t,n){}initialize(t,n,r){}dispose(){for(const t of Object.keys(this)){const n=this[t];(n instanceof $e||n instanceof wi||n instanceof dt||n instanceof Wn)&&this[t].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Io=class extends Be{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,r,a){const o=e.state.buffers.stencil;o.setLocked(!1),o.setTest(!1)}},Po=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,ir="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Do=class extends Ze{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new ie(null),opacity:new ie(1)},blending:Rt,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Po,vertexShader:ir})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},Hi=class extends Be{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new Do,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new $e(1,1,{minFilter:Ie,magFilter:Ie,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,r,a){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==ht?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e!==null&&e.outputColorSpace===Qe&&(this.renderTarget.texture.colorSpace=Qe))}},Kr=new Jt,zi=class extends Be{constructor(e=!0,t=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,r,a){const o=this.overrideClearColor,l=this.overrideClearAlpha,u=e.getClearAlpha(),d=o!==null,h=l>=0;d?(e.getClearColor(Kr),e.setClearColor(o,h?l:u)):h&&e.setClearAlpha(l),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),d?e.setClearColor(Kr,u):h&&e.setClearAlpha(u)}},Lo=class extends Be{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new zi(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,r,a){const o=e.getContext(),l=e.state.buffers,u=this.scene,d=this.camera,h=this.clearPass,y=this.inverted?0:1,x=1-y;l.color.setMask(!1),l.depth.setMask(!1),l.color.setLocked(!0),l.depth.setLocked(!0),l.stencil.setTest(!0),l.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),l.stencil.setFunc(o.ALWAYS,y,4294967295),l.stencil.setClear(x),l.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?h.render(e,null):(h.render(e,t),h.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(u,d)):(e.setRenderTarget(t),e.render(u,d),e.setRenderTarget(n),e.render(u,d)),l.color.setLocked(!1),l.depth.setLocked(!1),l.stencil.setLocked(!1),l.stencil.setFunc(o.EQUAL,1,4294967295),l.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),l.stencil.setLocked(!0)}},Bo=class{constructor(t=null,{depthBuffer:n=!0,stencilBuffer:r=!1,multisampling:a=0,frameBufferType:o}={}){this.renderer=null,this.inputBuffer=this.createBuffer(n,r,o,a),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Hi,this.depthTexture=null,this.passes=[],this.timer=new Co,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){const n=this.inputBuffer,r=this.multisampling;r>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(n.depthBuffer,n.stencilBuffer,n.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){const n=t.getSize(new Te),r=t.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;a===ht&&t.outputColorSpace===Qe&&(this.inputBuffer.texture.colorSpace=Qe,this.outputBuffer.texture.colorSpace=Qe,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(n.width,n.height);for(const o of this.passes)o.initialize(t,r,a)}}replaceRenderer(t,n=!0){const r=this.renderer,a=r.domElement.parentNode;return this.setRenderer(t),n&&a!==null&&(a.removeChild(r.domElement),a.appendChild(t.domElement)),r}createDepthTexture(){const t=this.depthTexture=new Ma;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=Ta,t.type=ba):t.type=gi,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,n,r,a){const o=this.renderer,l=o===null?new Te:o.getDrawingBufferSize(new Te),u={minFilter:Ie,magFilter:Ie,stencilBuffer:n,depthBuffer:t,type:r},d=new $e(l.width,l.height,u);return a>0&&(d.ignoreDepthForMultisampleCopy=!1,d.samples=a),r===ht&&o!==null&&o.outputColorSpace===Qe&&(d.texture.colorSpace=Qe),d.texture.name="EffectComposer.Buffer",d.texture.generateMipmaps=!1,d}setMainScene(t){for(const n of this.passes)n.mainScene=t}setMainCamera(t){for(const n of this.passes)n.mainCamera=t}addPass(t,n){const r=this.passes,a=this.renderer,o=a.getDrawingBufferSize(new Te),l=a.getContext().getContextAttributes().alpha,u=this.inputBuffer.texture.type;if(t.setRenderer(a),t.setSize(o.width,o.height),t.initialize(a,l,u),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),n!==void 0?r.splice(n,0,t):r.push(t),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const d=this.createDepthTexture();for(t of r)t.setDepthTexture(d)}else t.setDepthTexture(this.depthTexture)}removePass(t){const n=this.passes,r=n.indexOf(t);if(r!==-1&&n.splice(r,1).length>0){if(this.depthTexture!==null){const l=(d,h)=>d||h.needsDepthTexture;n.reduce(l,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===n.length&&(t.renderToScreen=!1,n.length>0&&(n[n.length-1].renderToScreen=!0))}}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const n=this.renderer,r=this.copyPass;let a=this.inputBuffer,o=this.outputBuffer,l=!1,u,d,h;t===void 0&&(this.timer.update(),t=this.timer.getDelta());for(const y of this.passes)y.enabled&&(y.render(n,a,o,t,l),y.needsSwap&&(l&&(r.renderToScreen=y.renderToScreen,u=n.getContext(),d=n.state.buffers.stencil,d.setFunc(u.NOTEQUAL,1,4294967295),r.render(n,a,o,t,l),d.setFunc(u.EQUAL,1,4294967295)),h=a,a=o,o=h),y instanceof Lo?l=!0:y instanceof Io&&(l=!1))}setSize(t,n,r){const a=this.renderer,o=a.getSize(new Te);(t===void 0||n===void 0)&&(t=o.width,n=o.height),(o.width!==t||o.height!==n)&&a.setSize(t,n,r);const l=a.getDrawingBufferSize(new Te);this.inputBuffer.setSize(l.width,l.height),this.outputBuffer.setSize(l.width,l.height);for(const u of this.passes)u.setSize(l.width,l.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Be.fullscreenGeometry.dispose()}},it={NONE:0,DEPTH:1,CONVOLUTION:2},ee={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Oo=class{constructor(){this.shaderParts=new Map([[ee.FRAGMENT_HEAD,null],[ee.FRAGMENT_MAIN_UV,null],[ee.FRAGMENT_MAIN_IMAGE,null],[ee.VERTEX_HEAD,null],[ee.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=it.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Qt}},Bn=!1,Jr=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let n;if(t.material.flatShading)switch(t.material.side){case Et:n=this.materialsFlatShadedDoubleSide;break;case dn:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(t.material.side){case Et:n=this.materialsDoubleSide;break;case dn:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=n[2]:t.isInstancedMesh?t.material=n[1]:t.material=n[0],++this.meshCount}}}cloneMaterial(e){if(!(e instanceof Ze))return e.clone();const t=e.uniforms,n=new Map;for(const a in t){const o=t[a].value;o.isRenderTargetTexture&&(t[a].value=null,n.set(a,o))}const r=e.clone();for(const a of n)t[a[0]].value=a[1],r.uniforms[a[0]].value=a[1];return r}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){const t=this.materials=[this.cloneMaterial(e),this.cloneMaterial(e),this.cloneMaterial(e)];for(const n of t)n.uniforms=Object.assign({},e.uniforms),n.side=Aa;t[2].skinning=!0,this.materialsBackSide=t.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.side=dn,r}),this.materialsDoubleSide=t.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.side=Et,r}),this.materialsFlatShaded=t.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=t.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=dn,r}),this.materialsFlatShadedDoubleSide=t.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=Et,r})}}render(e,t,n){const r=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Bn){const a=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(const o of a)o[0].material=o[1];this.meshCount!==a.size&&a.clear()}else{const a=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=a}e.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Bn}static set workaroundEnabled(e){Bn=e}},ct=-1,at=class extends Xn{constructor(e,t=ct,n=ct,r=1){super(),this.resizable=e,this.baseSize=new Te(1,1),this.preferredSize=new Te(t,n),this.target=this.preferredSize,this.s=r,this.effectiveSize=new Te,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const e=this.baseSize,t=this.preferredSize,n=this.effectiveSize,r=this.scale;t.width!==ct?n.width=t.width:t.height!==ct?n.width=Math.round(t.height*(e.width/Math.max(e.height,1))):n.width=Math.round(e.width*r),t.height!==ct?n.height=t.height:t.width!==ct?n.height=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n.height=Math.round(e.height*r)}get width(){return this.effectiveSize.width}set width(e){this.preferredWidth=e}get height(){return this.effectiveSize.height}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferredSize.setScalar(ct),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.baseSize.width}set baseWidth(e){this.baseSize.width!==e&&(this.baseSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(e){this.baseWidth=e}get baseHeight(){return this.baseSize.height}set baseHeight(e){this.baseSize.height!==e&&(this.baseSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.baseSize.width!==e||this.baseSize.height!==t)&&(this.baseSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(e){this.preferredSize.width!==e&&(this.preferredSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferredSize.height}set preferredHeight(e){this.preferredSize.height!==e&&(this.preferredSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferredSize.width!==e||this.preferredSize.height!==t)&&(this.preferredSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(e){this.s=e.scale,this.baseSize.set(e.baseWidth,e.baseHeight),this.preferredSize.set(e.preferredWidth,e.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return ct}},Q={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},No="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",Fo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",Uo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",Ho="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",zo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",ko="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",Go="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",Wo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",Vo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",jo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",Zo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",$o="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",Xo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",qo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",Yo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",Qo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",Ko="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",Jo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",el="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",tl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",nl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",rl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",il="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",al="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",sl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",ol="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",ll="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",cl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",ul="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",dl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",fl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",hl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",pl=new Map([[Q.ADD,No],[Q.ALPHA,Fo],[Q.AVERAGE,Uo],[Q.COLOR,Ho],[Q.COLOR_BURN,zo],[Q.COLOR_DODGE,ko],[Q.DARKEN,Go],[Q.DIFFERENCE,Wo],[Q.DIVIDE,Vo],[Q.DST,null],[Q.EXCLUSION,jo],[Q.HARD_LIGHT,Zo],[Q.HARD_MIX,$o],[Q.HUE,Xo],[Q.INVERT,qo],[Q.INVERT_RGB,Yo],[Q.LIGHTEN,Qo],[Q.LINEAR_BURN,Ko],[Q.LINEAR_DODGE,Jo],[Q.LINEAR_LIGHT,el],[Q.LUMINOSITY,tl],[Q.MULTIPLY,nl],[Q.NEGATION,rl],[Q.NORMAL,il],[Q.OVERLAY,al],[Q.PIN_LIGHT,sl],[Q.REFLECT,ol],[Q.SATURATION,ll],[Q.SCREEN,cl],[Q.SOFT_LIGHT,ul],[Q.SRC,dl],[Q.SUBTRACT,fl],[Q.VIVID_LIGHT,hl]]),ml=class extends Xn{constructor(e,t=1){super(),this._blendFunction=e,this.opacity=new ie(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this._blendFunction}set blendFunction(e){this._blendFunction=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return pl.get(this.blendFunction)}},vl=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,gl=class extends Ze{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:qn.replace(/\D+/g,"")},uniforms:{inputBuffer:new ie(null),threshold:new ie(0),smoothing:new ie(1),range:new ie(null)},blending:Rt,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:vl,vertexShader:ir}),this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},yl=class extends Be{constructor({renderTarget:e,luminanceRange:t,colorOutput:n,resolutionScale:r=1,width:a=at.AUTO_SIZE,height:o=at.AUTO_SIZE,resolutionX:l=a,resolutionY:u=o}={}){super("LuminancePass"),this.fullscreenMaterial=new gl(n,t),this.needsSwap=!1,this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new $e(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const d=this.resolution=new at(this,l,u,r);d.addEventListener("change",h=>this.setSize(d.baseWidth,d.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,r,a){const o=this.fullscreenMaterial;o.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){n!==void 0&&n!==ht&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Sn=class extends Xn{constructor(e,t,{attributes:n=it.NONE,blendFunction:r=Q.NORMAL,defines:a=new Map,uniforms:o=new Map,extensions:l=null,vertexShader:u=null}={}){super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=u,this.defines=a,this.uniforms=o,this.extensions=l,this.blendMode=new ml(r),this.blendMode.addEventListener("change",d=>this.setChanged()),this._inputColorSpace=Qt,this._outputColorSpace=xi}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=Ct){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof $e||t instanceof wi||t instanceof dt||t instanceof Be)&&this[e].dispose()}}},ki=class extends Be{constructor(e,t,n=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new zi,this.overrideMaterialManager=n===null?null:new Jr(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new Jr(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,r,a){const o=this.scene,l=this.camera,u=this.selection,d=l.layers.mask,h=o.background,y=e.shadowMap.autoUpdate,x=this.renderToScreen?null:t;u!==null&&l.layers.set(u.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(o.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(x),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,o,l):e.render(o,l),l.layers.mask=d,o.background=h,e.shadowMap.autoUpdate=y}},De={LINEAR:0,REINHARD:1,REINHARD2:2,REINHARD2_ADAPTIVE:3,UNCHARTED2:4,OPTIMIZED_CINEON:5,CINEON:5,ACES_FILMIC:6,AGX:7,NEUTRAL:8},Zt={DEFAULT:0,ESKIL:1},xl=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,wl="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",El=class extends Ze{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new ie(null),normalBuffer:new ie(null),texelSize:new ie(new Te)},blending:Rt,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:xl,vertexShader:wl})}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Ct){this.depthBuffer=e,this.depthPacking=t}set normalBuffer(e){this.uniforms.normalBuffer.value=e,e!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(e){this.normalBuffer=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Sl=class extends Be{constructor({normalBuffer:e=null,resolutionScale:t=.5,width:n=at.AUTO_SIZE,height:r=at.AUTO_SIZE,resolutionX:a=n,resolutionY:o=r}={}){super("DepthDownsamplingPass");const l=new El;l.normalBuffer=e,this.fullscreenMaterial=l,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new $e(1,1,{minFilter:Tt,magFilter:Tt,depthBuffer:!1,type:Ke}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const u=this.resolution=new at(this,a,o,t);u.addEventListener("change",d=>this.setSize(u.baseWidth,u.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(e,t=Ct){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t}render(e,t,n,r,a){e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(e,t)}initialize(e,t,n){const r=e.getContext();if(!(r.getExtension("EXT_color_buffer_float")||r.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},_l=`#include <packing>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
uniform lowp sampler2D luminanceBuffer0;uniform lowp sampler2D luminanceBuffer1;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float l0=unpackRGBAToFloat(texture2D(luminanceBuffer0,vUv));
#if __VERSION__ < 300
float l1=texture2DLodEXT(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#else
float l1=textureLod(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#endif
l0=max(minLuminance,l0);l1=max(minLuminance,l1);float adaptedLum=l0+(l1-l0)*(1.0-exp(-deltaTime*tau));gl_FragColor=(adaptedLum==1.0)?vec4(1.0):packFloatToRGBA(adaptedLum);}`,Ml=class extends Ze{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new ie(null),luminanceBuffer1:new ie(null),minLuminance:new ie(.01),deltaTime:new ie(0),tau:new ie(1)},extensions:{shaderTextureLOD:!0},blending:Rt,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:_l,vertexShader:ir})}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}},Tl=class extends Be{constructor(e,{minLuminance:t=.01,adaptationRate:n=1}={}){super("AdaptiveLuminancePass"),this.fullscreenMaterial=new Ml,this.needsSwap=!1,this.renderTargetPrevious=new $e(1,1,{minFilter:Tt,magFilter:Tt,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const r=this.fullscreenMaterial;r.luminanceBuffer0=this.renderTargetPrevious.texture,r.luminanceBuffer1=e,r.minLuminance=t,r.adaptationRate=n,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new Hi(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,n,r,a){this.fullscreenMaterial.deltaTime=r,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}},bl=`#include <tonemapping_pars_fragment>
uniform float whitePoint;
#if TONE_MAPPING_MODE == 2 || TONE_MAPPING_MODE == 3
uniform float middleGrey;
#if TONE_MAPPING_MODE == 3
uniform lowp sampler2D luminanceBuffer;
#else
uniform float averageLuminance;
#endif
vec3 Reinhard2ToneMapping(vec3 color){color*=toneMappingExposure;float l=luminance(color);
#if TONE_MAPPING_MODE == 3
float lumAvg=unpackRGBAToFloat(texture2D(luminanceBuffer,vec2(0.5)));
#else
float lumAvg=averageLuminance;
#endif
float lumScaled=(l*middleGrey)/max(lumAvg,1e-6);float lumCompressed=lumScaled*(1.0+lumScaled/(whitePoint*whitePoint));lumCompressed/=(1.0+lumScaled);return clamp(lumCompressed*color,0.0,1.0);}
#elif TONE_MAPPING_MODE == 4
#define A 0.15
#define B 0.50
#define C 0.10
#define D 0.20
#define E 0.02
#define F 0.30
vec3 Uncharted2Helper(const in vec3 x){return((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}vec3 Uncharted2ToneMapping(vec3 color){color*=toneMappingExposure;return clamp(Uncharted2Helper(color)/Uncharted2Helper(vec3(whitePoint)),0.0,1.0);}
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){
#if TONE_MAPPING_MODE == 2 || TONE_MAPPING_MODE == 3
outputColor=vec4(Reinhard2ToneMapping(inputColor.rgb),inputColor.a);
#elif TONE_MAPPING_MODE == 4
outputColor=vec4(Uncharted2ToneMapping(inputColor.rgb),inputColor.a);
#else
outputColor=vec4(toneMapping(inputColor.rgb),inputColor.a);
#endif
}`,Rl=class extends Sn{constructor({blendFunction:e=Q.SRC,adaptive:t=!1,mode:n=t?De.REINHARD2_ADAPTIVE:De.AGX,resolution:r=256,maxLuminance:a=4,whitePoint:o=a,middleGrey:l=.6,minLuminance:u=.01,averageLuminance:d=1,adaptationRate:h=1}={}){super("ToneMappingEffect",bl,{blendFunction:e,uniforms:new Map([["luminanceBuffer",new ie(null)],["maxLuminance",new ie(a)],["whitePoint",new ie(o)],["middleGrey",new ie(l)],["averageLuminance",new ie(d)]])}),this.renderTargetLuminance=new $e(1,1,{minFilter:Ia,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new yl({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new Tl(this.luminancePass.texture,{minLuminance:u,adaptationRate:h}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=r,this.mode=n}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode===e)return;const n=qn.replace(/\D+/g,"")>=168?"CineonToneMapping(texel)":"OptimizedCineonToneMapping(texel)";switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case De.LINEAR:this.defines.set("toneMapping(texel)","LinearToneMapping(texel)");break;case De.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case De.CINEON:case De.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)",n);break;case De.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;case De.AGX:this.defines.set("toneMapping(texel)","AgXToneMapping(texel)");break;case De.NEUTRAL:this.defines.set("toneMapping(texel)","NeutralToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel");break}this.adaptiveLuminancePass.enabled=e===De.REINHARD2_ADAPTIVE,this.setChanged()}getMode(){return this.mode}setMode(e){this.mode=e}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(e){this.uniforms.get("whitePoint").value=e}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(e){this.uniforms.get("middleGrey").value=e}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(e){this.uniforms.get("averageLuminance").value=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),n=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(n,n),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===De.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?De.REINHARD2_ADAPTIVE:De.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,n){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,n))}initialize(e,t,n){this.adaptiveLuminancePass.initialize(e,t,n)}},Cl=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,Al=class extends Sn{constructor({blendFunction:e,eskil:t=!1,technique:n=t?Zt.ESKIL:Zt.DEFAULT,offset:r=.5,darkness:a=.5}={}){super("VignetteEffect",Cl,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",n.toFixed(0)]]),uniforms:new Map([["offset",new ie(r)],["darkness",new ie(a)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===Zt.ESKIL}set eskil(e){this.technique=e?Zt.ESKIL:Zt.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},Il=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Pl="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Dl=class extends Ze{constructor(e,t,n,r,a=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:qn.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new ie(null),depthBuffer:new ie(null),resolution:new ie(new Te),texelSize:new ie(new Te),cameraNear:new ie(.3),cameraFar:new ie(1e3),aspect:new ie(1),time:new ie(0)},blending:Rt,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:a}),e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.copyCameraSettings(r)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Ct){this.depthBuffer=e,this.depthPacking=t}setShaderData(e){this.setShaderParts(e.shaderParts),this.setDefines(e.defines),this.setUniforms(e.uniforms),this.setExtensions(e.extensions)}setShaderParts(e){return this.fragmentShader=Il.replace(ee.FRAGMENT_HEAD,e.get(ee.FRAGMENT_HEAD)||"").replace(ee.FRAGMENT_MAIN_UV,e.get(ee.FRAGMENT_MAIN_UV)||"").replace(ee.FRAGMENT_MAIN_IMAGE,e.get(ee.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Pl.replace(ee.VERTEX_HEAD,e.get(ee.VERTEX_HEAD)||"").replace(ee.VERTEX_MAIN_SUPPORT,e.get(ee.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Zn?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return ee}};function ei(e,t,n){for(const r of t){const a="$1"+e+r.charAt(0).toUpperCase()+r.slice(1),o=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(const l of n.entries())l[1]!==null&&n.set(l[0],l[1].replace(o,a))}}function Ll(e,t,n){let r=t.getFragmentShader(),a=t.getVertexShader();const o=r!==void 0&&/mainImage/.test(r),l=r!==void 0&&/mainUv/.test(r);if(n.attributes|=t.getAttributes(),r===void 0)throw new Error(`Missing fragment shader (${t.name})`);if(l&&n.attributes&it.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${t.name})`);if(!o&&!l)throw new Error(`Could not find mainImage or mainUv function (${t.name})`);{const u=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,d=n.shaderParts;let h=d.get(ee.FRAGMENT_HEAD)||"",y=d.get(ee.FRAGMENT_MAIN_UV)||"",x=d.get(ee.FRAGMENT_MAIN_IMAGE)||"",S=d.get(ee.VERTEX_HEAD)||"",B=d.get(ee.VERTEX_MAIN_SUPPORT)||"";const j=new Set,$=new Set;if(l&&(y+=`	${e}MainUv(UV);
`,n.uvTransformation=!0),a!==null&&/mainSupport/.test(a)){const U=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a);B+=`	${e}MainSupport(`,B+=U?`vUv);
`:`);
`;for(const D of a.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const X of D[1].split(/\s*,\s*/))n.varyings.add(X),j.add(X),$.add(X);for(const D of a.matchAll(u))$.add(D[1])}for(const U of r.matchAll(u))$.add(U[1]);for(const U of t.defines.keys())$.add(U.replace(/\([\w\s,]*\)/g,""));for(const U of t.uniforms.keys())$.add(U);$.delete("while"),$.delete("for"),$.delete("if"),t.uniforms.forEach((U,D)=>n.uniforms.set(e+D.charAt(0).toUpperCase()+D.slice(1),U)),t.defines.forEach((U,D)=>n.defines.set(e+D.charAt(0).toUpperCase()+D.slice(1),U));const G=new Map([["fragment",r],["vertex",a]]);ei(e,$,n.defines),ei(e,$,G),r=G.get("fragment"),a=G.get("vertex");const P=t.blendMode;if(n.blendModes.set(P.blendFunction,P),o){t.inputColorSpace!==null&&t.inputColorSpace!==n.colorSpace&&(x+=t.inputColorSpace===Qe?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),t.outputColorSpace!==xi?n.colorSpace=t.outputColorSpace:t.inputColorSpace!==null&&(n.colorSpace=t.inputColorSpace);const U=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;x+=`${e}MainImage(color0, UV, `,n.attributes&it.DEPTH&&U.test(r)&&(x+="depth, ",n.readDepth=!0),x+=`color1);
	`;const D=e+"BlendOpacity";n.uniforms.set(D,P.opacity),x+=`color0 = blend${P.blendFunction}(color0, color1, ${D});

	`,h+=`uniform float ${D};

`}if(h+=r+`
`,a!==null&&(S+=a+`
`),d.set(ee.FRAGMENT_HEAD,h),d.set(ee.FRAGMENT_MAIN_UV,y),d.set(ee.FRAGMENT_MAIN_IMAGE,x),d.set(ee.VERTEX_HEAD,S),d.set(ee.VERTEX_MAIN_SUPPORT,B),t.extensions!==null)for(const U of t.extensions)n.extensions.add(U)}}var Bl=class extends Be{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new Dl(null,null,null,e),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(t),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(e){for(const t of this.effects)t.mainScene=e}set mainCamera(e){this.fullscreenMaterial.copyCameraSettings(e);for(const t of this.effects)t.mainCamera=e}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}setEffects(e){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=e.sort((t,n)=>n.attributes-t.attributes);for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const e=new Oo;let t=0;for(const l of this.effects)if(l.blendMode.blendFunction===Q.DST)e.attributes|=l.getAttributes()&it.DEPTH;else{if(e.attributes&l.getAttributes()&it.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${l.name})`);Ll("e"+t++,l,e)}let n=e.shaderParts.get(ee.FRAGMENT_HEAD),r=e.shaderParts.get(ee.FRAGMENT_MAIN_IMAGE),a=e.shaderParts.get(ee.FRAGMENT_MAIN_UV);const o=/\bblend\b/g;for(const l of e.blendModes.values())n+=l.getShaderCode().replace(o,`blend${l.blendFunction}`)+`
`;e.attributes&it.DEPTH?(e.readDepth&&(r=`float depth = readDepth(UV);

	`+r),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,e.colorSpace===Qe&&(r+=`color0 = sRGBToLinear(color0);
	`),e.uvTransformation?(a=`vec2 transformedUv = vUv;
`+a,e.defines.set("UV","transformedUv")):e.defines.set("UV","vUv"),e.shaderParts.set(ee.FRAGMENT_HEAD,n),e.shaderParts.set(ee.FRAGMENT_MAIN_IMAGE,r),e.shaderParts.set(ee.FRAGMENT_MAIN_UV,a);for(const[l,u]of e.shaderParts)u!==null&&e.shaderParts.set(l,u.trim().replace(/^#/,`
#`));this.skipRendering=t===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(e)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=Ct){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,r,a){for(const o of this.effects)o.update(e,t,r);if(!this.skipRendering||this.renderToScreen){const o=this.fullscreenMaterial;o.inputBuffer=t.texture,o.time+=r*this.timeScale,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(const r of this.effects)r.initialize(e,t,n);this.updateMaterial(),n!==void 0&&n!==ht&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.removeEventListener("change",this.listener),e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},Ol=class extends Be{constructor(e,t,{renderTarget:n,resolutionScale:r=1,width:a=at.AUTO_SIZE,height:o=at.AUTO_SIZE,resolutionX:l=a,resolutionY:u=o}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new ki(e,t,new Ra);const d=this.renderPass;d.ignoreBackground=!0,d.skipShadowMapUpdate=!0;const h=d.getClearPass();h.overrideClearColor=new Jt(7829503),h.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new $e(1,1,{minFilter:Tt,magFilter:Tt}),this.renderTarget.texture.name="NormalPass.Target");const y=this.resolution=new at(this,l,u,r);y.addEventListener("change",x=>this.setSize(y.baseWidth,y.baseHeight))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,r,a){const o=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,o,o)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}};const Nl=v.createContext(null),ti=e=>(e.getAttributes()&it.CONVOLUTION)===it.CONVOLUTION,Fl=qt.memo(v.forwardRef(({children:e,camera:t,scene:n,resolutionScale:r,enabled:a=!0,renderPriority:o=1,autoClear:l=!0,depthBuffer:u,enableNormalPass:d,stencilBuffer:h,multisampling:y=8,frameBufferType:x=Le},S)=>{const{gl:B,scene:j,camera:$,size:G}=Ge(),P=n||j,U=t||$,[D,X,Z]=v.useMemo(()=>{const E=Gs(),g=new Bo(B,{depthBuffer:u,stencilBuffer:h,multisampling:y>0&&E?y:0,frameBufferType:x});g.addPass(new ki(P,U));let H=null,R=null;return d&&(R=new Ol(P,U),R.enabled=!1,g.addPass(R),r!==void 0&&E&&(H=new Sl({normalBuffer:R.texture,resolutionScale:r}),H.enabled=!1,g.addPass(H))),[g,R,H]},[U,B,u,h,y,x,P,d,r]);v.useEffect(()=>D==null?void 0:D.setSize(G.width,G.height),[D,G]),pt((E,g)=>{if(a){const H=B.autoClear;B.autoClear=l,h&&!l&&B.clearStencil(),D.render(g),B.autoClear=H}},a?o:0);const O=v.useRef(null);v.useLayoutEffect(()=>{var E;const g=[],H=(E=O.current)==null?void 0:E.__r3f;if(H&&D){const R=H.objects;for(let N=0;N<R.length;N++){const M=R[N];if(M instanceof Sn){const I=[M];if(!ti(M)){let W=null;for(;(W=R[N+1])instanceof Sn&&!ti(W);)I.push(W),N++}const F=new Bl(U,...I);g.push(F)}else M instanceof Be&&g.push(M)}for(const N of g)D==null||D.addPass(N);X&&(X.enabled=!0),Z&&(Z.enabled=!0)}return()=>{for(const R of g)D==null||D.removePass(R);X&&(X.enabled=!1),Z&&(Z.enabled=!1)}},[D,e,U,X,Z]),v.useEffect(()=>{const E=B.toneMapping;return B.toneMapping=Pa,()=>{B.toneMapping=E}},[B]);const K=v.useMemo(()=>({composer:D,normalPass:X,downSamplingPass:Z,resolutionScale:r,camera:U,scene:P}),[D,X,Z,r,U,P]);return v.useImperativeHandle(S,()=>D,[D]),z.jsx(Nl.Provider,{value:K,children:z.jsx("group",{ref:O,children:e})})}));let Ul=0;const ni=new WeakMap,Gi=(e,t)=>qt.forwardRef(function({blendFunction:r=void 0,opacity:a=void 0,...o},l){let u=ni.get(e);if(!u){const y=`@react-three/postprocessing/${e.name}-${Ul++}`;$n({[y]:e}),ni.set(e,u=y)}const d=Ge(y=>y.camera),h=qt.useMemo(()=>{var y,x;return[...(y=void 0)!=null?y:[],...(x=o.args)!=null?x:[{...t,...o}]]},[JSON.stringify(o)]);return z.jsx(u,{camera:d,"blendMode-blendFunction":r,"blendMode-opacity-value":a,...o,ref:l,args:h})}),Hl=Gi(Rl),zl=Gi(Al),kl=v.createContext(void 0),Gl=({initialPoi:e,children:t})=>{const[n,r]=v.useState(e),[a,o]=v.useState(null),l=u=>{o(n),r(u)};return z.jsx(kl.Provider,{value:{activePoi:n,previousPoi:a,setActivePoi:l},children:t})},Wl=({modelData:e})=>z.jsx("group",{dispose:null,children:e.map((t,n)=>z.jsx(Vl,{...t},n))});function Vl(e){const t=di+e.path,{scene:n}=Si(t),r=v.useMemo(()=>{const a=new Da;return a.position.copy(n.position),a.rotation.copy(n.rotation),a.scale.copy(n.scale),n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),a.add(n),a},[n]);return v.useEffect(()=>{n.traverse(a=>{a.isMesh&&(a.castShadow=!0,a.receiveShadow=!0)})},[n]),z.jsx("primitive",{object:r,dispose:null})}const mn=[{name:"Start",offset:0},{name:"Boat front",offset:.38,threeDText:{text:"Communicate complex ideas in a simple way!",position:[-.0819,.2569,.234],rotation:[0,0,0],scale:[3e-5,3e-5,3e-5],outlineColor:"#000000",outlineWidth:.005}},{name:"Windmill side",offset:.52,threeDText:{text:"Find new and engaging ways to present your ideas and products",position:[-.082,.27,.224],rotation:[0,-Math.PI/2,0],scale:[.004,.004,.004]}},{name:"Windmill",offset:.707,threeDText:{text:"Highly technical models that you can interact with",position:[-.08,.23,.19],rotation:[0,Math.PI,0],scale:[.08,.08,.08]}},{name:"Robot Pickup",offset:.85,threeDText:{text:"Tailor your sales journey to your customer needs",position:[-.08,.6,1.2],rotation:[0,2.2,0],scale:[.3,.3,.3]}}],jl=({title:e,description:t,parentStyling:n})=>z.jsx(ja,{sx:{display:"flex",flexDirection:"column",maxWidth:"25rem",height:"25rem",backgroundColor:"rgba(0, 0, 0, 0.8)",pointerEvents:"none",borderRadius:"5rem",padding:"3rem",...n},children:z.jsxs(qa,{sx:{flex:1},children:[e&&z.jsx(Nn,{variant:"h5",component:"div",sx:{fontFamily:"Red Hat Display",fontWeight:700,color:"white",paddingBottom:1},children:e}),t&&t.map((r,a)=>z.jsx(Nn,{variant:"body2",sx:{fontFamily:"Red Hat Display",fontWeight:400,color:"white",paddingTop:1},children:r},a))]})}),Zl=({modelData:e,scrollLength:t=1})=>z.jsx(ks,{pages:t,children:z.jsx($l,{modelData:e,stopDelay:600})});function $l({modelData:e,stopDelay:t=1e3}){const{camera:n}=Ge(),r=zs(),a=di+e.path,{scene:o,animations:l}=Si(a),u=o.getObjectByName("RS_Camera"),d=o.getObjectByName("Rotor"),{actions:h}=oo(l,o),[y,x]=v.useState(0),[S,B]=v.useState(0);v.useEffect(()=>void(h.Animation.play().paused=!0),[h]);const j=mn,$=.08,[G,P]=v.useState(0),[U,D]=v.useState(!1),[X,Z]=v.useState(!0),[O,K]=v.useState(!1);v.useEffect(()=>{r.el&&(r.el.style.overflow="scroll",r.el.style.scrollbarWidth="none",r.el.style.msOverflowStyle="none")},[r]),o.traverse(M=>{M.name.includes("Placeholder")&&(M.visible=!1),M.name.includes("PlaneToHide")&&(M.visible=!1)});const E=()=>{for(let M=0;M<j.length;M++)if(Math.abs(r.offset-j[M].offset)<$){if(M===G)return;D(!0),Z(!0),r.el.style.touchAction="none",P(M),console.log("Scroll locked to stop: ",M),setTimeout(()=>{D(!1),r.el.style.touchAction="auto",console.log("Scroll unlocked")},t);break}},g=M=>{U?M.preventDefault():X&&!O&&(K(!0),setTimeout(()=>{Z(!1),K(!1)},1e3))},H=()=>{if(u){const M=u.getWorldPosition(new we),I=u.getWorldQuaternion(new bt);n.position.set(M.x,M.y,M.z),n.quaternion.set(I.x,I.y,I.z,I.w),S<.2?(n.near=2e-5,n.far=1):S<.6?(n.near=1e-4,n.far=5):(n.near=.02,n.far=80),n.updateProjectionMatrix()}else console.warn("RS_Camera not found in scene.")},R=v.useRef(null),N=v.useRef(null);return v.useEffect(()=>{if(!R.current){const M=document.getElementById("ui-overlay");if(!M){console.error("UI overlay not found!");return}const I=document.createElement("div");I.id="scrollOverlay",I.style.position="absolute",I.style.pointerEvents="none",I.style.top="0vh",I.style.left="0",I.style.width="100%",I.style.height=`${200*mn.length}vh`,M.appendChild(I),R.current=I,N.current=ci.createRoot(I),N.current.render(z.jsx(z.Fragment,{children:mn.map((F,W)=>F.poiInfo&&z.jsx(fi,{sx:{position:"absolute",top:`${F.offset*(mn.length-1)*200+50}vh`,left:"2rem",right:"2rem",transform:"translateY(-50%)",pointerEvents:"none"},children:z.jsx(jl,{title:F.poiInfo.title,description:F.poiInfo.description,image:F.poiInfo.image,globalPath:F.poiInfo.globalPath})},W))}))}return()=>{var M;N.current&&N.current.unmount(),(M=R.current)==null||M.remove()}},[]),v.useEffect(()=>(r.el.addEventListener("wheel",g,{passive:!1}),r.el.addEventListener("touchmove",g,{passive:!1}),()=>{r.el.removeEventListener("wheel",g),r.el.removeEventListener("touchmove",g)})),pt((M,I)=>{const F=h.Animation;!U&&!X&&(Vn||E()),d&&d.rotateZ(I*-1.6),U?(r.el.scrollTop=j[G].offset*(r.el.scrollHeight-r.el.clientHeight),x(j[G].offset)):x(r.offset),Math.abs(F.time/F.getClip().duration-y)>1e-4?F.time=gn.damp(F.time,F.getClip().duration*y,3,I):F.time=F.getClip().duration*y,B(F.time/F.getClip().duration),R.current&&(R.current.style.top=-(S*200*(j.length-1))+"vh"),H(),Vn&&(console.log("Scroll offset: ",r.offset),console.log("Animation offset: ",S))}),z.jsxs("group",{scale:10,children:[z.jsx("primitive",{object:o,dispose:null}),j.map((M,I)=>M.threeDText&&z.jsx(Xl,{text:M.threeDText.text,position:M.threeDText.position,rotation:M.threeDText.rotation,scale:M.threeDText.scale,stopOffset:M.offset,scrollOffset:S,color:M.threeDText.color,outlineColor:M.threeDText.outlineColor,outlineWidth:M.threeDText.outlineWidth},I))]})}const Xl=({text:e,position:t=[0,0,0],rotation:n=[0,0,0],scale:r=[1,1,1],scrollOffset:a,stopOffset:o,fadeDistance:l=.08,color:u="#ffffff",outlineColor:d=u,outlineWidth:h=0})=>{const[y,x]=v.useState(0);return v.useEffect(()=>{const S=Math.abs(a-o),B=1-Math.min(S/l,1);x(B)},[a,o,l]),z.jsx(La,{font:"fonts/RedHatDisplay-SemiBold.ttf",color:u,anchorY:"top",anchorX:"left",fontSize:.5,position:t,rotation:n,scale:r,maxWidth:5,lineHeight:1.2,fillOpacity:y,outlineColor:d,outlineWidth:h,children:e})},ql=()=>{const{progress:e}=us();return z.jsx(as,{center:!0,children:z.jsxs(fi,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",children:[z.jsx(Ba,{size:80,thickness:4}),z.jsxs(Nn,{variant:"h6",color:"textPrimary",mt:2,children:[Math.round(e),"% Loaded"]})]})})},On={sceneTitle:"Scroll Demo",sceneModels:[{path:"/models/scrollDemo3.glb",castShadow:!0,receiveShadow:!0}],canvasSettings:{backgroundColor:"#666666",antialias:!0,environmentProps:{preset:"studio",background:!1,environmentIntensity:.1,backgroundBlurriness:.1},usePostEffects:!0},parentPoi:{name:"Test scene parent POI",description:"The parent POI for the test scene, encompassing all child POIs.",type:"staticObject",isMaster:!0,cameraControls:{type:"orbit",enablePan:!1,startPosition:{x:0,y:2,z:10},targetOffset:{x:0,y:1,z:0},constraints:{up:50,down:-1,minZoom:1,maxZoom:12}}},debugSettings:{allTrue:!1,gridHelper:!1,axesHelper:!1,stats:!1,lightHelpers:!1}},Yl=({cameraSettings:e,debugSettings:t})=>{const{scene:n}=Ge();let r=n.getObjectByName("cameraFocusObject");if(!r){if(r=new Fn,r.name="cameraFocusObject",e!=null&&e.lookAt&&r.position.set(e.lookAt.x,e.lookAt.y,e.lookAt.z),t!=null&&t.allTrue){const a=new Oa(.05,32,32),o=new yi({color:16711680}),l=new en(a,o);r.add(l)}n.add(r)}return null};$n({ShaderMaterial:Ze});const Ql=()=>{const e=v.useRef(null),t=v.useMemo(()=>{const r=new Ei,a=[],o=[];for(let l=0;l<1e3;l++){const u=gn.randFloatSpread(6),d=Math.max(-10,gn.randFloatSpread(10)),h=gn.randFloatSpread(6);a.push(u,d,h),o.push(Math.random()*3+.5)}return r.setAttribute("position",new dr(a,3)),r.setAttribute("size",new dr(o,1)),r},[]),n=v.useMemo(()=>new Ze({uniforms:{color:{value:new Jt("white")},time:{value:0}},vertexShader:`
        uniform vec3 color;
        attribute float size;
        varying vec3 vColor;
        uniform float time;

        void main() {
          vColor = color;
          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
          gl_PointSize = size * (8.0 / -mvPosition.z);
          gl_Position = projectionMatrix * mvPosition;
        }
        `,fragmentShader:`
        uniform float time;
        varying vec3 vColor;

        void main() {
          float brightness = abs(sin(time + gl_FragCoord.x / 100.0));
          vec3 lightBlue = vec3(1.0, 1.0, 1.0);

          vec2 coordinates = 2.0 * gl_PointCoord - 1.0;
          float radius = dot(coordinates, coordinates);
          if (radius > 1.0) {
            discard;
          }

          float glow = 1.0 - radius;
          gl_FragColor = vec4(lightBlue * brightness * glow, brightness * glow * 0.2);
        }
        `,transparent:!0,blending:Na,depthTest:!1,depthWrite:!1}),[]);return pt(({clock:r})=>{e.current&&(n.uniforms.time.value=r.getElapsedTime())}),z.jsx("points",{ref:e,geometry:t,material:n})};let Vn=!1;const rc=()=>{const e=v.useRef(null),t=v.useRef(null),n=v.useRef(null),[r,a]=v.useState(!1),o=()=>{a(S=>!S)},[l,u]=v.useState(!1),d=()=>{u(S=>!S)},[h,y]=v.useState(!1),x=()=>{y(S=>!S)};return v.useEffect(()=>{Vn=h},[h]),z.jsx("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",backgroundColor:"#666666"},children:z.jsxs(Gl,{initialPoi:On.parentPoi,children:[z.jsxs(Fa,{ref:e,camera:{position:new we(0,2,10),near:2e-5,far:1},gl:{powerPreference:"high-performance",alpha:!1,antialias:!0},shadows:!l,children:[z.jsx("color",{attach:"background",args:["#666666"]}),z.jsxs(v.Suspense,{fallback:z.jsx(ql,{}),children:[z.jsx(Wl,{modelData:On.sceneModels}),z.jsx(bo,{files:"images/hdri/blurred.hdr"}),z.jsx(Kl,{debugMode:h}),z.jsx(Ua,{frameSize:8}),z.jsx(Yl,{}),z.jsx(Zl,{modelData:On.sceneModels[0],scrollLength:10}),z.jsx(Ql,{}),z.jsx("fog",{attach:"fog",args:["#666666",40,60]}),r&&z.jsx(Ha,{}),!l&&z.jsx(Jl,{})]})]}),z.jsx("div",{id:"overlay",ref:t,className:"absolute left-0 top-0 h-full w-full pointer-events-none overflow-hidden"}),z.jsx("div",{ref:n,id:"ui-overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"hidden"},children:z.jsx(za,{showStats:r,onToggleStats:o,usePerformanceMode:l,onTogglePerformanceMode:d,debugMode:h,onToggleDebugMode:x})})]})})},Kl=({debugMode:e})=>{const t=v.useRef();return so(e?t:null,ka),z.jsxs("group",{children:[z.jsx("directionalLight",{color:"#ffffff",position:[5,5,-10],castShadow:!0,intensity:20,"shadow-mapSize":[1024,1024],"shadow-bias":-.01}),z.jsx("directionalLight",{position:[-5,5,5],intensity:.4,"shadow-mapSize":[128,128]}),z.jsx("directionalLight",{position:[-5,5,-5],intensity:.4,"shadow-mapSize":[128,128]}),z.jsx("directionalLight",{position:[0,5,0],intensity:.4,"shadow-mapSize":[128,128]})]})},Jl=()=>z.jsx(z.Fragment,{children:z.jsxs(Fl,{children:[z.jsx(Hl,{}),z.jsx(zl,{eskil:!1,offset:.1,darkness:.8})]})});export{rc as default,Vn as useDebug};
